Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/1.5/pdb/5.rst.pickle
***********************************************************

start: bond:  0.013 angle:   1.16 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   9.09 Z:  -4.92 cb:   0.00
cycle:   0 max_shift: 0.180507 LBFGS: function start/end, n_calls: 260.408352 50.124376 52
cycle:   1 max_shift: 0.104533 LBFGS: function start/end, n_calls: 50.124376 46.900062 53
cycle:   2 max_shift: 0.099330 LBFGS: function start/end, n_calls: 46.900062 44.808735 52
cycle:   3 max_shift: 0.077842 LBFGS: function start/end, n_calls: 44.808735 43.725266 52
cycle:   4 max_shift: 0.086042 LBFGS: function start/end, n_calls: 43.725266 42.833996 52
cycle:   5 max_shift: 0.041571 LBFGS: function start/end, n_calls: 42.833996 42.288106 53
cycle:   6 max_shift: 0.076996 LBFGS: function start/end, n_calls: 42.288106 41.859657 52
cycle:   7 max_shift: 0.019165 LBFGS: function start/end, n_calls: 41.859657 41.603602 52
cycle:   8 max_shift: 0.142812 LBFGS: function start/end, n_calls: 41.603602 41.183305 52
cycle:   9 max_shift: 0.013367 LBFGS: function start/end, n_calls: 41.183305 41.077797 52
cycle:  10 max_shift: 0.167028 LBFGS: function start/end, n_calls: 41.077797 40.906208 52
cycle:  11 max_shift: 0.019012 LBFGS: function start/end, n_calls: 40.906208 40.830971 52
cycle:  12 max_shift: 0.035213 LBFGS: function start/end, n_calls: 40.830971 40.801283 52
cycle:  13 max_shift: 0.009397 LBFGS: function start/end, n_calls: 40.801283 40.787202 53
cycle:  14 max_shift: 0.015844 LBFGS: function start/end, n_calls: 40.787202 40.767565 52
cycle:  15 max_shift: 0.013532 LBFGS: function start/end, n_calls: 40.767565 40.749328 52
cycle:  16 max_shift: 0.008492 LBFGS: function start/end, n_calls: 40.749328 40.734395 52
cycle:  17 max_shift: 0.016635 LBFGS: function start/end, n_calls: 40.734395 40.719572 52
cycle:  18 max_shift: 0.009786 LBFGS: function start/end, n_calls: 40.719572 40.705191 52
cycle:  19 max_shift: 0.020602 LBFGS: function start/end, n_calls: 40.705191 40.690875 52
cycle:  20 max_shift: 0.009348 LBFGS: function start/end, n_calls: 40.690875 40.676651 52
cycle:  21 max_shift: 0.061265 LBFGS: function start/end, n_calls: 40.676651 40.646886 52
cycle:  22 max_shift: 0.015413 LBFGS: function start/end, n_calls: 40.646886 40.611651 52
cycle:  23 max_shift: 0.041124 LBFGS: function start/end, n_calls: 40.611651 40.588067 52
cycle:  24 max_shift: 0.008858 LBFGS: function start/end, n_calls: 40.588067 40.569137 52
cycle:  25 max_shift: 0.017979 LBFGS: function start/end, n_calls: 40.569137 40.558551 53
cycle:  26 max_shift: 0.010314 LBFGS: function start/end, n_calls: 40.558551 40.548400 52
cycle:  27 max_shift: 0.015125 LBFGS: function start/end, n_calls: 40.548400 40.538086 52
cycle:  28 max_shift: 0.010056 LBFGS: function start/end, n_calls: 40.538086 40.526893 52
cycle:  29 max_shift: 0.015667 LBFGS: function start/end, n_calls: 40.526893 40.515270 52
cycle:  30 max_shift: 0.018160 LBFGS: function start/end, n_calls: 40.515270 40.500029 52
cycle:  31 max_shift: 0.011174 LBFGS: function start/end, n_calls: 40.500029 40.486888 52
cycle:  32 max_shift: 0.022032 LBFGS: function start/end, n_calls: 40.486888 40.472405 52
cycle:  33 max_shift: 0.010991 LBFGS: function start/end, n_calls: 40.472405 40.457777 52
cycle:  34 max_shift: 0.018839 LBFGS: function start/end, n_calls: 40.457777 40.444269 52
cycle:  35 max_shift: 0.013569 LBFGS: function start/end, n_calls: 40.444269 40.431004 52
cycle:  36 max_shift: 0.031340 LBFGS: function start/end, n_calls: 40.431004 40.412444 52
cycle:  37 max_shift: 0.010035 LBFGS: function start/end, n_calls: 40.412444 40.394347 53
cycle:  38 max_shift: 0.034007 LBFGS: function start/end, n_calls: 40.394347 40.374659 52
cycle:  39 max_shift: 0.010165 LBFGS: function start/end, n_calls: 40.374659 40.359087 52
cycle:  40 max_shift: 0.030868 LBFGS: function start/end, n_calls: 40.359087 40.342745 52
cycle:  41 max_shift: 0.008283 LBFGS: function start/end, n_calls: 40.342745 40.328739 52
cycle:  42 max_shift: 0.022278 LBFGS: function start/end, n_calls: 40.328739 40.316267 52
cycle:  43 max_shift: 0.007670 LBFGS: function start/end, n_calls: 40.316267 40.307070 52
cycle:  44 max_shift: 0.025328 LBFGS: function start/end, n_calls: 40.307070 40.295042 52
cycle:  45 max_shift: 0.005272 LBFGS: function start/end, n_calls: 40.295042 40.285958 52
cycle:  46 max_shift: 0.010132 LBFGS: function start/end, n_calls: 40.285958 40.279997 52
cycle:  47 max_shift: 0.006374 LBFGS: function start/end, n_calls: 40.279997 40.274605 52
cycle:  48 max_shift: 0.009811 LBFGS: function start/end, n_calls: 40.274605 40.269169 52
cycle:  49 max_shift: 0.004431 LBFGS: function start/end, n_calls: 40.269169 40.264132 52
cycle:  50 max_shift: 0.023226 LBFGS: function start/end, n_calls: 40.264132 40.253129 52
cycle:  51 max_shift: 0.004820 LBFGS: function start/end, n_calls: 40.253129 40.245578 52
cycle:  52 max_shift: 0.014302 LBFGS: function start/end, n_calls: 40.245578 40.239847 52
cycle:  53 max_shift: 0.004135 LBFGS: function start/end, n_calls: 40.239847 40.235116 52
cycle:  54 max_shift: 0.043395 LBFGS: function start/end, n_calls: 40.235116 40.221585 52
cycle:  55 max_shift: 0.007082 LBFGS: function start/end, n_calls: 40.221585 40.207477 52
cycle:  56 max_shift: 0.012589 LBFGS: function start/end, n_calls: 40.207477 40.202850 52
cycle:  57 max_shift: 0.004333 LBFGS: function start/end, n_calls: 40.202850 40.198832 52
cycle:  58 max_shift: 0.003875 LBFGS: function start/end, n_calls: 40.198832 40.197186 53
cycle:  59 max_shift: 0.004750 LBFGS: function start/end, n_calls: 40.197186 40.195076 53
cycle:  60 max_shift: 0.005881 LBFGS: function start/end, n_calls: 40.195076 40.192256 52
cycle:  61 max_shift: 0.004360 LBFGS: function start/end, n_calls: 40.192256 40.189588 52
cycle:  62 max_shift: 0.015286 LBFGS: function start/end, n_calls: 40.189588 40.183764 52
cycle:  63 max_shift: 0.004576 LBFGS: function start/end, n_calls: 40.183764 40.178792 52
cycle:  64 max_shift: 0.012382 LBFGS: function start/end, n_calls: 40.178792 40.174130 52
cycle:  65 max_shift: 0.004644 LBFGS: function start/end, n_calls: 40.174130 40.169844 52
cycle:  66 max_shift: 0.009259 LBFGS: function start/end, n_calls: 40.169844 40.166340 53
cycle:  67 max_shift: 0.005811 LBFGS: function start/end, n_calls: 40.166340 40.162121 52
cycle:  68 max_shift: 0.006780 LBFGS: function start/end, n_calls: 40.162121 40.159115 52
cycle:  69 max_shift: 0.005022 LBFGS: function start/end, n_calls: 40.159115 40.155476 52
cycle:  70 max_shift: 0.005654 LBFGS: function start/end, n_calls: 40.155476 40.152424 52
cycle:  71 max_shift: 0.003024 LBFGS: function start/end, n_calls: 40.152424 40.150124 53
cycle:  72 max_shift: 0.009166 LBFGS: function start/end, n_calls: 40.150124 40.146488 52
cycle:  73 max_shift: 0.002756 LBFGS: function start/end, n_calls: 40.146488 40.143259 52
cycle:  74 max_shift: 0.006488 LBFGS: function start/end, n_calls: 40.143259 40.140804 52
cycle:  75 max_shift: 0.003019 LBFGS: function start/end, n_calls: 40.140804 40.138275 53
cycle:  76 max_shift: 0.006282 LBFGS: function start/end, n_calls: 40.138275 40.135853 52
cycle:  77 max_shift: 0.003290 LBFGS: function start/end, n_calls: 40.135853 40.133200 52
cycle:  78 max_shift: 0.009293 LBFGS: function start/end, n_calls: 40.133200 40.129551 52
cycle:  79 max_shift: 0.003923 LBFGS: function start/end, n_calls: 40.129551 40.126146 52
cycle:  80 max_shift: 0.006486 LBFGS: function start/end, n_calls: 40.126146 40.123583 54
cycle:  81 max_shift: 0.003626 LBFGS: function start/end, n_calls: 40.123583 40.120759 53
cycle:  82 max_shift: 0.031850 LBFGS: function start/end, n_calls: 40.120759 40.109212 52
cycle:  83 max_shift: 0.006332 LBFGS: function start/end, n_calls: 40.109212 40.099982 52
cycle:  84 max_shift: 0.016786 LBFGS: function start/end, n_calls: 40.099982 40.094994 53
cycle:  85 max_shift: 0.005159 LBFGS: function start/end, n_calls: 40.094994 40.088959 52
cycle:  86 max_shift: 0.025188 LBFGS: function start/end, n_calls: 40.088959 40.079054 52
cycle:  87 max_shift: 0.005176 LBFGS: function start/end, n_calls: 40.079054 40.072172 52
cycle:  88 max_shift: 0.062846 LBFGS: function start/end, n_calls: 40.072172 40.053543 52
cycle:  89 max_shift: 0.008100 LBFGS: function start/end, n_calls: 40.053543 40.030856 52
cycle:  90 max_shift: 0.018788 LBFGS: function start/end, n_calls: 40.030856 40.024384 53
cycle:  91 max_shift: 0.005039 LBFGS: function start/end, n_calls: 40.024384 40.016654 52
cycle:  92 max_shift: 0.017339 LBFGS: function start/end, n_calls: 40.016654 40.009862 52
cycle:  93 max_shift: 0.004827 LBFGS: function start/end, n_calls: 40.009862 40.003511 52
cycle:  94 max_shift: 0.013871 LBFGS: function start/end, n_calls: 40.003511 39.998173 52
cycle:  95 max_shift: 0.005089 LBFGS: function start/end, n_calls: 39.998173 39.992625 52
cycle:  96 max_shift: 0.020931 LBFGS: function start/end, n_calls: 39.992625 39.984661 52
cycle:  97 max_shift: 0.005802 LBFGS: function start/end, n_calls: 39.984661 39.977577 52
cycle:  98 max_shift: 0.018908 LBFGS: function start/end, n_calls: 39.977577 39.970926 52
cycle:  99 max_shift: 0.005501 LBFGS: function start/end, n_calls: 39.970926 39.963972 52
final: bond:  0.000 angle:   0.26 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   9.09 Z:  -4.13 cb:   0.00
See 5_refined.pdb in pdb folder.
Time: 5.1426
