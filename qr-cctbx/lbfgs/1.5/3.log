Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/1.5/pdb/3.rst.pickle
***********************************************************

start: bond:  0.015 angle:   1.56 clash:   0.0 rota:  0.00 rama: f:  63.64 o:   9.09 Z:  -5.32 cb:   0.00
cycle:   0 max_shift: 0.223830 LBFGS: function start/end, n_calls: 300.559186 50.420327 52
cycle:   1 max_shift: 0.087389 LBFGS: function start/end, n_calls: 50.420327 46.478892 52
cycle:   2 max_shift: 0.060169 LBFGS: function start/end, n_calls: 46.478892 44.519628 52
cycle:   3 max_shift: 0.042026 LBFGS: function start/end, n_calls: 44.519628 43.598809 53
cycle:   4 max_shift: 0.104377 LBFGS: function start/end, n_calls: 43.598809 42.504418 52
cycle:   5 max_shift: 0.030776 LBFGS: function start/end, n_calls: 42.504418 42.060140 53
cycle:   6 max_shift: 0.129760 LBFGS: function start/end, n_calls: 42.060140 41.630649 52
cycle:   7 max_shift: 0.021283 LBFGS: function start/end, n_calls: 41.630649 41.547131 52
cycle:   8 max_shift: 0.025503 LBFGS: function start/end, n_calls: 41.547131 41.496124 52
cycle:   9 max_shift: 0.015681 LBFGS: function start/end, n_calls: 41.496124 41.459873 52
cycle:  10 max_shift: 0.061038 LBFGS: function start/end, n_calls: 41.459873 41.388522 52
cycle:  11 max_shift: 0.009407 LBFGS: function start/end, n_calls: 41.388522 41.349179 54
cycle:  12 max_shift: 0.061946 LBFGS: function start/end, n_calls: 41.349179 41.299164 53
cycle:  13 max_shift: 0.013000 LBFGS: function start/end, n_calls: 41.299164 41.242941 52
cycle:  14 max_shift: 0.073983 LBFGS: function start/end, n_calls: 41.242941 41.181667 52
cycle:  15 max_shift: 0.011467 LBFGS: function start/end, n_calls: 41.181667 41.114805 52
cycle:  16 max_shift: 0.080294 LBFGS: function start/end, n_calls: 41.114805 41.039343 52
cycle:  17 max_shift: 0.013766 LBFGS: function start/end, n_calls: 41.039343 40.966505 53
cycle:  18 max_shift: 0.155018 LBFGS: function start/end, n_calls: 40.966505 40.804802 52
cycle:  19 max_shift: 0.021027 LBFGS: function start/end, n_calls: 40.804802 40.683593 52
cycle:  20 max_shift: 0.012115 LBFGS: function start/end, n_calls: 40.683593 40.654343 53
cycle:  21 max_shift: 0.012714 LBFGS: function start/end, n_calls: 40.654343 40.633181 52
cycle:  22 max_shift: 0.014397 LBFGS: function start/end, n_calls: 40.633181 40.612017 52
cycle:  23 max_shift: 0.011848 LBFGS: function start/end, n_calls: 40.612017 40.592691 52
cycle:  24 max_shift: 0.016898 LBFGS: function start/end, n_calls: 40.592691 40.571090 52
cycle:  25 max_shift: 0.014290 LBFGS: function start/end, n_calls: 40.571090 40.543240 52
cycle:  26 max_shift: 0.052057 LBFGS: function start/end, n_calls: 40.543240 40.487540 52
cycle:  27 max_shift: 0.009916 LBFGS: function start/end, n_calls: 40.487540 40.448965 53
cycle:  28 max_shift: 0.058594 LBFGS: function start/end, n_calls: 40.448965 40.404894 52
cycle:  29 max_shift: 0.011130 LBFGS: function start/end, n_calls: 40.404894 40.358002 53
cycle:  30 max_shift: 0.044555 LBFGS: function start/end, n_calls: 40.358002 40.326071 52
cycle:  31 max_shift: 0.010417 LBFGS: function start/end, n_calls: 40.326071 40.292337 52
cycle:  32 max_shift: 0.022784 LBFGS: function start/end, n_calls: 40.292337 40.275792 53
cycle:  33 max_shift: 0.008967 LBFGS: function start/end, n_calls: 40.275792 40.255459 52
cycle:  34 max_shift: 0.110398 LBFGS: function start/end, n_calls: 40.255459 40.183646 52
cycle:  35 max_shift: 0.013018 LBFGS: function start/end, n_calls: 40.183646 40.118398 52
cycle:  36 max_shift: 0.035698 LBFGS: function start/end, n_calls: 40.118398 40.094787 52
cycle:  37 max_shift: 0.008681 LBFGS: function start/end, n_calls: 40.094787 40.074288 52
cycle:  38 max_shift: 0.033401 LBFGS: function start/end, n_calls: 40.074288 40.052567 52
cycle:  39 max_shift: 0.007164 LBFGS: function start/end, n_calls: 40.052567 40.034585 52
cycle:  40 max_shift: 0.022416 LBFGS: function start/end, n_calls: 40.034585 40.019872 52
cycle:  41 max_shift: 0.006481 LBFGS: function start/end, n_calls: 40.019872 40.007284 52
cycle:  42 max_shift: 0.017053 LBFGS: function start/end, n_calls: 40.007284 39.996865 52
cycle:  43 max_shift: 0.006737 LBFGS: function start/end, n_calls: 39.996865 39.985795 52
cycle:  44 max_shift: 0.013758 LBFGS: function start/end, n_calls: 39.985795 39.976200 52
cycle:  45 max_shift: 0.006623 LBFGS: function start/end, n_calls: 39.976200 39.967492 52
cycle:  46 max_shift: 0.018767 LBFGS: function start/end, n_calls: 39.967492 39.956270 52
cycle:  47 max_shift: 0.009089 LBFGS: function start/end, n_calls: 39.956270 39.945150 52
cycle:  48 max_shift: 0.009142 LBFGS: function start/end, n_calls: 39.945150 39.937689 52
cycle:  49 max_shift: 0.007015 LBFGS: function start/end, n_calls: 39.937689 39.931260 52
cycle:  50 max_shift: 0.007869 LBFGS: function start/end, n_calls: 39.931260 39.925888 53
cycle:  51 max_shift: 0.009736 LBFGS: function start/end, n_calls: 39.925888 39.917666 52
cycle:  52 max_shift: 0.012511 LBFGS: function start/end, n_calls: 39.917666 39.908678 52
cycle:  53 max_shift: 0.013296 LBFGS: function start/end, n_calls: 39.908678 39.898761 52
cycle:  54 max_shift: 0.007317 LBFGS: function start/end, n_calls: 39.898761 39.891286 52
cycle:  55 max_shift: 0.014448 LBFGS: function start/end, n_calls: 39.891286 39.883044 52
cycle:  56 max_shift: 0.007216 LBFGS: function start/end, n_calls: 39.883044 39.874261 52
cycle:  57 max_shift: 0.013432 LBFGS: function start/end, n_calls: 39.874261 39.867044 52
cycle:  58 max_shift: 0.011840 LBFGS: function start/end, n_calls: 39.867044 39.857009 52
cycle:  59 max_shift: 0.006309 LBFGS: function start/end, n_calls: 39.857009 39.851007 52
cycle:  60 max_shift: 0.006795 LBFGS: function start/end, n_calls: 39.851007 39.846552 52
cycle:  61 max_shift: 0.005861 LBFGS: function start/end, n_calls: 39.846552 39.841842 52
cycle:  62 max_shift: 0.009360 LBFGS: function start/end, n_calls: 39.841842 39.836402 52
cycle:  63 max_shift: 0.005353 LBFGS: function start/end, n_calls: 39.836402 39.831346 52
cycle:  64 max_shift: 0.009408 LBFGS: function start/end, n_calls: 39.831346 39.826458 52
cycle:  65 max_shift: 0.006208 LBFGS: function start/end, n_calls: 39.826458 39.821449 52
cycle:  66 max_shift: 0.007483 LBFGS: function start/end, n_calls: 39.821449 39.817622 53
cycle:  67 max_shift: 0.008141 LBFGS: function start/end, n_calls: 39.817622 39.812265 52
cycle:  68 max_shift: 0.008686 LBFGS: function start/end, n_calls: 39.812265 39.807070 52
cycle:  69 max_shift: 0.008330 LBFGS: function start/end, n_calls: 39.807070 39.801694 52
cycle:  70 max_shift: 0.008800 LBFGS: function start/end, n_calls: 39.801694 39.796484 52
cycle:  71 max_shift: 0.005938 LBFGS: function start/end, n_calls: 39.796484 39.792514 52
cycle:  72 max_shift: 0.008850 LBFGS: function start/end, n_calls: 39.792514 39.788262 52
cycle:  73 max_shift: 0.006889 LBFGS: function start/end, n_calls: 39.788262 39.783543 52
cycle:  74 max_shift: 0.010043 LBFGS: function start/end, n_calls: 39.783543 39.779181 52
cycle:  75 max_shift: 0.007076 LBFGS: function start/end, n_calls: 39.779181 39.774703 52
cycle:  76 max_shift: 0.008956 LBFGS: function start/end, n_calls: 39.774703 39.770827 52
cycle:  77 max_shift: 0.005750 LBFGS: function start/end, n_calls: 39.770827 39.767200 52
cycle:  78 max_shift: 0.009903 LBFGS: function start/end, n_calls: 39.767200 39.763634 52
cycle:  79 max_shift: 0.006420 LBFGS: function start/end, n_calls: 39.763634 39.759467 52
cycle:  80 max_shift: 0.016596 LBFGS: function start/end, n_calls: 39.759467 39.752903 52
cycle:  81 max_shift: 0.010486 LBFGS: function start/end, n_calls: 39.752903 39.745708 52
cycle:  82 max_shift: 0.008930 LBFGS: function start/end, n_calls: 39.745708 39.741083 52
cycle:  83 max_shift: 0.009334 LBFGS: function start/end, n_calls: 39.741083 39.736633 52
cycle:  84 max_shift: 0.005275 LBFGS: function start/end, n_calls: 39.736633 39.732964 52
cycle:  85 max_shift: 0.006223 LBFGS: function start/end, n_calls: 39.732964 39.730372 52
cycle:  86 max_shift: 0.005936 LBFGS: function start/end, n_calls: 39.730372 39.727611 52
cycle:  87 max_shift: 0.012469 LBFGS: function start/end, n_calls: 39.727611 39.722464 52
cycle:  88 max_shift: 0.006067 LBFGS: function start/end, n_calls: 39.722464 39.718041 52
cycle:  89 max_shift: 0.010320 LBFGS: function start/end, n_calls: 39.718041 39.714777 52
cycle:  90 max_shift: 0.006234 LBFGS: function start/end, n_calls: 39.714777 39.711116 52
cycle:  91 max_shift: 0.009548 LBFGS: function start/end, n_calls: 39.711116 39.708048 52
cycle:  92 max_shift: 0.005464 LBFGS: function start/end, n_calls: 39.708048 39.704903 52
cycle:  93 max_shift: 0.009629 LBFGS: function start/end, n_calls: 39.704903 39.701942 52
cycle:  94 max_shift: 0.005604 LBFGS: function start/end, n_calls: 39.701942 39.699131 53
cycle:  95 max_shift: 0.006388 LBFGS: function start/end, n_calls: 39.699131 39.696842 52
cycle:  96 max_shift: 0.006578 LBFGS: function start/end, n_calls: 39.696842 39.694390 52
cycle:  97 max_shift: 0.004956 LBFGS: function start/end, n_calls: 39.694390 39.692235 52
cycle:  98 max_shift: 0.005461 LBFGS: function start/end, n_calls: 39.692235 39.690501 54
cycle:  99 max_shift: 0.011027 LBFGS: function start/end, n_calls: 39.690501 39.687413 52
final: bond:  0.000 angle:   0.27 clash:   0.0 rota:  0.00 rama: f:  63.64 o:  27.27 Z:  -5.56 cb:   0.00
See 3_refined.pdb in pdb folder.
Time: 5.1020
