Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/1.5/pdb/4.rst.pickle
***********************************************************

start: bond:  0.013 angle:   1.49 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   0.00 Z:  -5.71 cb:   0.00
cycle:   0 max_shift: 0.180039 LBFGS: function start/end, n_calls: 301.647313 52.899098 52
cycle:   1 max_shift: 0.164613 LBFGS: function start/end, n_calls: 52.899098 49.777826 52
cycle:   2 max_shift: 0.096926 LBFGS: function start/end, n_calls: 49.777826 48.205619 52
cycle:   3 max_shift: 0.088183 LBFGS: function start/end, n_calls: 48.205619 47.209108 52
cycle:   4 max_shift: 0.060611 LBFGS: function start/end, n_calls: 47.209108 46.431043 52
cycle:   5 max_shift: 0.266712 LBFGS: function start/end, n_calls: 46.431043 44.835578 52
cycle:   6 max_shift: 0.046483 LBFGS: function start/end, n_calls: 44.835578 43.820550 52
cycle:   7 max_shift: 0.491059 LBFGS: function start/end, n_calls: 43.820550 41.749842 52
cycle:   8 max_shift: 0.024691 LBFGS: function start/end, n_calls: 41.749842 41.217537 52
cycle:   9 max_shift: 0.126480 LBFGS: function start/end, n_calls: 41.217537 40.921621 52
cycle:  10 max_shift: 0.028750 LBFGS: function start/end, n_calls: 40.921621 40.769349 52
cycle:  11 max_shift: 0.059290 LBFGS: function start/end, n_calls: 40.769349 40.649613 52
cycle:  12 max_shift: 0.019572 LBFGS: function start/end, n_calls: 40.649613 40.555768 52
cycle:  13 max_shift: 0.026733 LBFGS: function start/end, n_calls: 40.555768 40.485587 52
cycle:  14 max_shift: 0.022811 LBFGS: function start/end, n_calls: 40.485587 40.430705 52
cycle:  15 max_shift: 0.014316 LBFGS: function start/end, n_calls: 40.430705 40.383807 52
cycle:  16 max_shift: 0.061033 LBFGS: function start/end, n_calls: 40.383807 40.297008 52
cycle:  17 max_shift: 0.011809 LBFGS: function start/end, n_calls: 40.297008 40.225609 52
cycle:  18 max_shift: 0.080654 LBFGS: function start/end, n_calls: 40.225609 40.140676 52
cycle:  19 max_shift: 0.012576 LBFGS: function start/end, n_calls: 40.140676 40.063960 52
cycle:  20 max_shift: 0.027119 LBFGS: function start/end, n_calls: 40.063960 40.032937 52
cycle:  21 max_shift: 0.008241 LBFGS: function start/end, n_calls: 40.032937 40.006967 52
cycle:  22 max_shift: 0.032482 LBFGS: function start/end, n_calls: 40.006967 39.970063 52
cycle:  23 max_shift: 0.011983 LBFGS: function start/end, n_calls: 39.970063 39.937350 52
cycle:  24 max_shift: 0.014127 LBFGS: function start/end, n_calls: 39.937350 39.916709 52
cycle:  25 max_shift: 0.023857 LBFGS: function start/end, n_calls: 39.916709 39.892405 52
cycle:  26 max_shift: 0.009074 LBFGS: function start/end, n_calls: 39.892405 39.871399 52
cycle:  27 max_shift: 0.027745 LBFGS: function start/end, n_calls: 39.871399 39.851331 54
cycle:  28 max_shift: 0.008504 LBFGS: function start/end, n_calls: 39.851331 39.830937 52
cycle:  29 max_shift: 0.070793 LBFGS: function start/end, n_calls: 39.830937 39.782180 52
cycle:  30 max_shift: 0.006885 LBFGS: function start/end, n_calls: 39.782180 39.750800 53
cycle:  31 max_shift: 0.082543 LBFGS: function start/end, n_calls: 39.750800 39.710181 53
cycle:  32 max_shift: 0.009808 LBFGS: function start/end, n_calls: 39.710181 39.663683 52
cycle:  33 max_shift: 0.027142 LBFGS: function start/end, n_calls: 39.663683 39.646376 52
cycle:  34 max_shift: 0.006198 LBFGS: function start/end, n_calls: 39.646376 39.632739 52
cycle:  35 max_shift: 0.075347 LBFGS: function start/end, n_calls: 39.632739 39.598916 52
cycle:  36 max_shift: 0.009191 LBFGS: function start/end, n_calls: 39.598916 39.561462 52
cycle:  37 max_shift: 0.042697 LBFGS: function start/end, n_calls: 39.561462 39.538287 52
cycle:  38 max_shift: 0.006271 LBFGS: function start/end, n_calls: 39.538287 39.520533 53
cycle:  39 max_shift: 0.019370 LBFGS: function start/end, n_calls: 39.520533 39.511049 52
cycle:  40 max_shift: 0.005026 LBFGS: function start/end, n_calls: 39.511049 39.499696 52
cycle:  41 max_shift: 0.057317 LBFGS: function start/end, n_calls: 39.499696 39.469671 52
cycle:  42 max_shift: 0.006220 LBFGS: function start/end, n_calls: 39.469671 39.449658 52
cycle:  43 max_shift: 0.018302 LBFGS: function start/end, n_calls: 39.449658 39.440834 52
cycle:  44 max_shift: 0.005182 LBFGS: function start/end, n_calls: 39.440834 39.434219 52
cycle:  45 max_shift: 0.008076 LBFGS: function start/end, n_calls: 39.434219 39.429970 52
cycle:  46 max_shift: 0.005509 LBFGS: function start/end, n_calls: 39.429970 39.425155 52
cycle:  47 max_shift: 0.007089 LBFGS: function start/end, n_calls: 39.425155 39.420631 52
cycle:  48 max_shift: 0.005036 LBFGS: function start/end, n_calls: 39.420631 39.417209 52
cycle:  49 max_shift: 0.006220 LBFGS: function start/end, n_calls: 39.417209 39.414080 52
cycle:  50 max_shift: 0.004637 LBFGS: function start/end, n_calls: 39.414080 39.410894 53
cycle:  51 max_shift: 0.005592 LBFGS: function start/end, n_calls: 39.410894 39.408168 52
cycle:  52 max_shift: 0.004188 LBFGS: function start/end, n_calls: 39.408168 39.405137 52
cycle:  53 max_shift: 0.007518 LBFGS: function start/end, n_calls: 39.405137 39.401378 52
cycle:  54 max_shift: 0.004718 LBFGS: function start/end, n_calls: 39.401378 39.398096 53
cycle:  55 max_shift: 0.004415 LBFGS: function start/end, n_calls: 39.398096 39.396152 54
cycle:  56 max_shift: 0.006980 LBFGS: function start/end, n_calls: 39.396152 39.392959 52
cycle:  57 max_shift: 0.004070 LBFGS: function start/end, n_calls: 39.392959 39.389905 53
cycle:  58 max_shift: 0.006011 LBFGS: function start/end, n_calls: 39.389905 39.387686 52
cycle:  59 max_shift: 0.003791 LBFGS: function start/end, n_calls: 39.387686 39.384756 52
cycle:  60 max_shift: 0.009684 LBFGS: function start/end, n_calls: 39.384756 39.381451 53
cycle:  61 max_shift: 0.003912 LBFGS: function start/end, n_calls: 39.381451 39.377746 52
cycle:  62 max_shift: 0.008420 LBFGS: function start/end, n_calls: 39.377746 39.374843 52
cycle:  63 max_shift: 0.002661 LBFGS: function start/end, n_calls: 39.374843 39.371832 52
cycle:  64 max_shift: 0.012416 LBFGS: function start/end, n_calls: 39.371832 39.367961 52
cycle:  65 max_shift: 0.003045 LBFGS: function start/end, n_calls: 39.367961 39.363969 52
cycle:  66 max_shift: 0.015605 LBFGS: function start/end, n_calls: 39.363969 39.358781 52
cycle:  67 max_shift: 0.002936 LBFGS: function start/end, n_calls: 39.358781 39.355049 52
cycle:  68 max_shift: 0.012613 LBFGS: function start/end, n_calls: 39.355049 39.350639 52
cycle:  69 max_shift: 0.002233 LBFGS: function start/end, n_calls: 39.350639 39.348243 52
cycle:  70 max_shift: 0.003873 LBFGS: function start/end, n_calls: 39.348243 39.347036 53
cycle:  71 max_shift: 0.003497 LBFGS: function start/end, n_calls: 39.347036 39.345249 52
cycle:  72 max_shift: 0.026255 LBFGS: function start/end, n_calls: 39.345249 39.338699 52
cycle:  73 max_shift: 0.004340 LBFGS: function start/end, n_calls: 39.338699 39.332688 52
cycle:  74 max_shift: 0.006786 LBFGS: function start/end, n_calls: 39.332688 39.331133 52
cycle:  75 max_shift: 0.004288 LBFGS: function start/end, n_calls: 39.331133 39.328836 52
cycle:  76 max_shift: 0.002112 LBFGS: function start/end, n_calls: 39.328836 39.327593 52
cycle:  77 max_shift: 0.004446 LBFGS: function start/end, n_calls: 39.327593 39.326332 52
cycle:  78 max_shift: 0.002226 LBFGS: function start/end, n_calls: 39.326332 39.325053 52
cycle:  79 max_shift: 0.002049 LBFGS: function start/end, n_calls: 39.325053 39.324209 52
cycle:  80 max_shift: 0.003067 LBFGS: function start/end, n_calls: 39.324209 39.323146 52
cycle:  81 max_shift: 0.002064 LBFGS: function start/end, n_calls: 39.323146 39.322161 52
cycle:  82 max_shift: 0.002712 LBFGS: function start/end, n_calls: 39.322161 39.321333 52
cycle:  83 max_shift: 0.001725 LBFGS: function start/end, n_calls: 39.321333 39.320539 53
cycle:  84 max_shift: 0.002687 LBFGS: function start/end, n_calls: 39.320539 39.319758 52
cycle:  85 max_shift: 0.001506 LBFGS: function start/end, n_calls: 39.319758 39.319078 53
cycle:  86 max_shift: 0.008721 LBFGS: function start/end, n_calls: 39.319078 39.316919 52
cycle:  87 max_shift: 0.008125 LBFGS: function start/end, n_calls: 39.316919 39.314168 53
cycle:  88 max_shift: 0.002418 LBFGS: function start/end, n_calls: 39.314168 39.312318 52
cycle:  89 max_shift: 0.023109 LBFGS: function start/end, n_calls: 39.312318 39.308233 52
cycle:  90 max_shift: 0.004486 LBFGS: function start/end, n_calls: 39.308233 39.303816 52
cycle:  91 max_shift: 0.006075 LBFGS: function start/end, n_calls: 39.303816 39.302801 52
cycle:  92 max_shift: 0.002049 LBFGS: function start/end, n_calls: 39.302801 39.301419 52
cycle:  93 max_shift: 0.009758 LBFGS: function start/end, n_calls: 39.301419 39.299475 52
cycle:  94 max_shift: 0.002823 LBFGS: function start/end, n_calls: 39.299475 39.297623 52
cycle:  95 max_shift: 0.003768 LBFGS: function start/end, n_calls: 39.297623 39.296959 53
cycle:  96 max_shift: 0.001587 LBFGS: function start/end, n_calls: 39.296959 39.296257 53
cycle:  97 max_shift: 0.002138 LBFGS: function start/end, n_calls: 39.296257 39.295822 52
cycle:  98 max_shift: 0.001248 LBFGS: function start/end, n_calls: 39.295822 39.295277 52
cycle:  99 max_shift: 0.002905 LBFGS: function start/end, n_calls: 39.295277 39.294622 52
final: bond:  0.000 angle:   0.25 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   0.00 Z:  -6.13 cb:   0.00
See 4_refined.pdb in pdb folder.
Time: 5.0592
