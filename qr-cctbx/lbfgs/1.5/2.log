Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/1.5/pdb/2.rst.pickle
***********************************************************

start: bond:  0.014 angle:   1.51 clash:   0.0 rota:  0.00 rama: f: 100.00 o:   0.00 Z:  -5.00 cb:   0.00
cycle:   0 max_shift: 0.260587 LBFGS: function start/end, n_calls: 289.128522 52.028843 52
cycle:   1 max_shift: 0.179545 LBFGS: function start/end, n_calls: 52.028843 46.669963 52
cycle:   2 max_shift: 0.058388 LBFGS: function start/end, n_calls: 46.669963 44.949481 52
cycle:   3 max_shift: 0.087793 LBFGS: function start/end, n_calls: 44.949481 44.095509 52
cycle:   4 max_shift: 0.062555 LBFGS: function start/end, n_calls: 44.095509 43.515533 52
cycle:   5 max_shift: 0.031407 LBFGS: function start/end, n_calls: 43.515533 43.267106 52
cycle:   6 max_shift: 0.130877 LBFGS: function start/end, n_calls: 43.267106 42.869336 52
cycle:   7 max_shift: 0.040665 LBFGS: function start/end, n_calls: 42.869336 42.672838 52
cycle:   8 max_shift: 0.031710 LBFGS: function start/end, n_calls: 42.672838 42.549523 52
cycle:   9 max_shift: 0.029137 LBFGS: function start/end, n_calls: 42.549523 42.438343 52
cycle:  10 max_shift: 0.025944 LBFGS: function start/end, n_calls: 42.438343 42.346847 52
cycle:  11 max_shift: 0.030497 LBFGS: function start/end, n_calls: 42.346847 42.242042 52
cycle:  12 max_shift: 0.050639 LBFGS: function start/end, n_calls: 42.242042 42.118192 52
cycle:  13 max_shift: 0.021678 LBFGS: function start/end, n_calls: 42.118192 42.001513 53
cycle:  14 max_shift: 0.068694 LBFGS: function start/end, n_calls: 42.001513 41.839662 52
cycle:  15 max_shift: 0.014655 LBFGS: function start/end, n_calls: 41.839662 41.716792 52
cycle:  16 max_shift: 0.104238 LBFGS: function start/end, n_calls: 41.716792 41.471950 52
cycle:  17 max_shift: 0.022179 LBFGS: function start/end, n_calls: 41.471950 41.296543 52
cycle:  18 max_shift: 0.061473 LBFGS: function start/end, n_calls: 41.296543 41.153564 53
cycle:  19 max_shift: 0.022134 LBFGS: function start/end, n_calls: 41.153564 41.029421 53
cycle:  20 max_shift: 0.071521 LBFGS: function start/end, n_calls: 41.029421 40.898232 52
cycle:  21 max_shift: 0.021848 LBFGS: function start/end, n_calls: 40.898232 40.768605 52
cycle:  22 max_shift: 0.109070 LBFGS: function start/end, n_calls: 40.768605 40.573357 52
cycle:  23 max_shift: 0.019745 LBFGS: function start/end, n_calls: 40.573357 40.462693 52
cycle:  24 max_shift: 0.035980 LBFGS: function start/end, n_calls: 40.462693 40.400488 52
cycle:  25 max_shift: 0.011606 LBFGS: function start/end, n_calls: 40.400488 40.358423 52
cycle:  26 max_shift: 0.037544 LBFGS: function start/end, n_calls: 40.358423 40.307709 53
cycle:  27 max_shift: 0.019380 LBFGS: function start/end, n_calls: 40.307709 40.251850 52
cycle:  28 max_shift: 0.036139 LBFGS: function start/end, n_calls: 40.251850 40.206038 53
cycle:  29 max_shift: 0.011351 LBFGS: function start/end, n_calls: 40.206038 40.168587 53
cycle:  30 max_shift: 0.137714 LBFGS: function start/end, n_calls: 40.168587 40.022791 52
cycle:  31 max_shift: 0.005498 LBFGS: function start/end, n_calls: 40.022791 39.978299 52
cycle:  32 max_shift: 0.023179 LBFGS: function start/end, n_calls: 39.978299 39.961262 52
cycle:  33 max_shift: 0.006009 LBFGS: function start/end, n_calls: 39.961262 39.949481 52
cycle:  34 max_shift: 0.018639 LBFGS: function start/end, n_calls: 39.949481 39.938361 53
cycle:  35 max_shift: 0.011084 LBFGS: function start/end, n_calls: 39.938361 39.925469 52
cycle:  36 max_shift: 0.004180 LBFGS: function start/end, n_calls: 39.925469 39.918695 52
cycle:  37 max_shift: 0.024661 LBFGS: function start/end, n_calls: 39.918695 39.905520 52
cycle:  38 max_shift: 0.004379 LBFGS: function start/end, n_calls: 39.905520 39.893752 52
cycle:  39 max_shift: 0.015548 LBFGS: function start/end, n_calls: 39.893752 39.886090 52
cycle:  40 max_shift: 0.003837 LBFGS: function start/end, n_calls: 39.886090 39.878338 52
cycle:  41 max_shift: 0.013763 LBFGS: function start/end, n_calls: 39.878338 39.872191 52
cycle:  42 max_shift: 0.003395 LBFGS: function start/end, n_calls: 39.872191 39.865606 52
cycle:  43 max_shift: 0.026030 LBFGS: function start/end, n_calls: 39.865606 39.854703 52
cycle:  44 max_shift: 0.003610 LBFGS: function start/end, n_calls: 39.854703 39.845925 52
cycle:  45 max_shift: 0.008736 LBFGS: function start/end, n_calls: 39.845925 39.843025 52
cycle:  46 max_shift: 0.002483 LBFGS: function start/end, n_calls: 39.843025 39.840247 53
cycle:  47 max_shift: 0.013923 LBFGS: function start/end, n_calls: 39.840247 39.835042 52
cycle:  48 max_shift: 0.004052 LBFGS: function start/end, n_calls: 39.835042 39.830858 52
cycle:  49 max_shift: 0.003476 LBFGS: function start/end, n_calls: 39.830858 39.829032 52
cycle:  50 max_shift: 0.003152 LBFGS: function start/end, n_calls: 39.829032 39.827287 52
cycle:  51 max_shift: 0.003105 LBFGS: function start/end, n_calls: 39.827287 39.825874 53
cycle:  52 max_shift: 0.002551 LBFGS: function start/end, n_calls: 39.825874 39.824482 52
cycle:  53 max_shift: 0.003703 LBFGS: function start/end, n_calls: 39.824482 39.823109 52
cycle:  54 max_shift: 0.003718 LBFGS: function start/end, n_calls: 39.823109 39.821166 52
cycle:  55 max_shift: 0.004041 LBFGS: function start/end, n_calls: 39.821166 39.819304 52
cycle:  56 max_shift: 0.001919 LBFGS: function start/end, n_calls: 39.819304 39.817860 52
cycle:  57 max_shift: 0.003400 LBFGS: function start/end, n_calls: 39.817860 39.816746 53
cycle:  58 max_shift: 0.001808 LBFGS: function start/end, n_calls: 39.816746 39.815594 54
cycle:  59 max_shift: 0.003996 LBFGS: function start/end, n_calls: 39.815594 39.814403 52
cycle:  60 max_shift: 0.001737 LBFGS: function start/end, n_calls: 39.814403 39.813090 52
cycle:  61 max_shift: 0.004812 LBFGS: function start/end, n_calls: 39.813090 39.811695 52
cycle:  62 max_shift: 0.005865 LBFGS: function start/end, n_calls: 39.811695 39.809328 52
cycle:  63 max_shift: 0.002309 LBFGS: function start/end, n_calls: 39.809328 39.807474 52
cycle:  64 max_shift: 0.010239 LBFGS: function start/end, n_calls: 39.807474 39.804458 52
cycle:  65 max_shift: 0.002047 LBFGS: function start/end, n_calls: 39.804458 39.802026 52
cycle:  66 max_shift: 0.004090 LBFGS: function start/end, n_calls: 39.802026 39.801118 53
cycle:  67 max_shift: 0.002373 LBFGS: function start/end, n_calls: 39.801118 39.799694 52
cycle:  68 max_shift: 0.008372 LBFGS: function start/end, n_calls: 39.799694 39.797569 52
cycle:  69 max_shift: 0.002026 LBFGS: function start/end, n_calls: 39.797569 39.795231 52
cycle:  70 max_shift: 0.002771 LBFGS: function start/end, n_calls: 39.795231 39.794432 52
cycle:  71 max_shift: 0.002153 LBFGS: function start/end, n_calls: 39.794432 39.793477 52
cycle:  72 max_shift: 0.002563 LBFGS: function start/end, n_calls: 39.793477 39.792650 53
cycle:  73 max_shift: 0.002035 LBFGS: function start/end, n_calls: 39.792650 39.791628 52
cycle:  74 max_shift: 0.014351 LBFGS: function start/end, n_calls: 39.791628 39.788552 52
cycle:  75 max_shift: 0.001607 LBFGS: function start/end, n_calls: 39.788552 39.784703 52
cycle:  76 max_shift: 0.010518 LBFGS: function start/end, n_calls: 39.784703 39.782059 52
cycle:  77 max_shift: 0.001815 LBFGS: function start/end, n_calls: 39.782059 39.779628 52
cycle:  78 max_shift: 0.008234 LBFGS: function start/end, n_calls: 39.779628 39.778111 52
cycle:  79 max_shift: 0.002043 LBFGS: function start/end, n_calls: 39.778111 39.776065 52
cycle:  80 max_shift: 0.010292 LBFGS: function start/end, n_calls: 39.776065 39.773822 52
cycle:  81 max_shift: 0.002304 LBFGS: function start/end, n_calls: 39.773822 39.771383 52
cycle:  82 max_shift: 0.005280 LBFGS: function start/end, n_calls: 39.771383 39.770436 52
cycle:  83 max_shift: 0.001711 LBFGS: function start/end, n_calls: 39.770436 39.769336 52
cycle:  84 max_shift: 0.002090 LBFGS: function start/end, n_calls: 39.769336 39.768771 52
cycle:  85 max_shift: 0.001370 LBFGS: function start/end, n_calls: 39.768771 39.768182 52
cycle:  86 max_shift: 0.002740 LBFGS: function start/end, n_calls: 39.768182 39.767572 52
cycle:  87 max_shift: 0.001405 LBFGS: function start/end, n_calls: 39.767572 39.766944 52
cycle:  88 max_shift: 0.002547 LBFGS: function start/end, n_calls: 39.766944 39.766418 52
cycle:  89 max_shift: 0.001262 LBFGS: function start/end, n_calls: 39.766418 39.765893 53
cycle:  90 max_shift: 0.002868 LBFGS: function start/end, n_calls: 39.765893 39.765390 53
cycle:  91 max_shift: 0.001366 LBFGS: function start/end, n_calls: 39.765390 39.764766 53
cycle:  92 max_shift: 0.003390 LBFGS: function start/end, n_calls: 39.764766 39.764098 52
cycle:  93 max_shift: 0.001290 LBFGS: function start/end, n_calls: 39.764098 39.763370 52
cycle:  94 max_shift: 0.017895 LBFGS: function start/end, n_calls: 39.763370 39.759598 52
cycle:  95 max_shift: 0.002125 LBFGS: function start/end, n_calls: 39.759598 39.756090 52
cycle:  96 max_shift: 0.007210 LBFGS: function start/end, n_calls: 39.756090 39.754777 52
cycle:  97 max_shift: 0.001975 LBFGS: function start/end, n_calls: 39.754777 39.753231 53
cycle:  98 max_shift: 0.003480 LBFGS: function start/end, n_calls: 39.753231 39.752731 53
cycle:  99 max_shift: 0.001347 LBFGS: function start/end, n_calls: 39.752731 39.752023 52
final: bond:  0.000 angle:   0.25 clash:   0.0 rota:  0.00 rama: f: 100.00 o:   0.00 Z:  -4.88 cb:   0.00
See 2_refined.pdb in pdb folder.
Time: 4.9819
