Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/0.9/pdb/4.rst.pickle
***********************************************************

start: bond:  0.013 angle:   1.72 clash:   0.0 rota:  0.00 rama: f:  81.82 o:   0.00 Z:  -3.95 cb:   0.00
cycle:   0 max_shift: 0.270026 LBFGS: function start/end, n_calls: 292.904981 46.610895 52
cycle:   1 max_shift: 0.122752 LBFGS: function start/end, n_calls: 46.610895 44.068469 52
cycle:   2 max_shift: 0.052989 LBFGS: function start/end, n_calls: 44.068469 43.286001 52
cycle:   3 max_shift: 0.054846 LBFGS: function start/end, n_calls: 43.286001 42.818525 52
cycle:   4 max_shift: 0.028896 LBFGS: function start/end, n_calls: 42.818525 42.534008 52
cycle:   5 max_shift: 0.205315 LBFGS: function start/end, n_calls: 42.534008 41.799390 52
cycle:   6 max_shift: 0.026232 LBFGS: function start/end, n_calls: 41.799390 41.342741 52
cycle:   7 max_shift: 0.180742 LBFGS: function start/end, n_calls: 41.342741 40.909613 52
cycle:   8 max_shift: 0.014805 LBFGS: function start/end, n_calls: 40.909613 40.768222 53
cycle:   9 max_shift: 0.085278 LBFGS: function start/end, n_calls: 40.768222 40.610974 52
cycle:  10 max_shift: 0.019367 LBFGS: function start/end, n_calls: 40.610974 40.551355 53
cycle:  11 max_shift: 0.031165 LBFGS: function start/end, n_calls: 40.551355 40.491233 52
cycle:  12 max_shift: 0.036679 LBFGS: function start/end, n_calls: 40.491233 40.437031 52
cycle:  13 max_shift: 0.030030 LBFGS: function start/end, n_calls: 40.437031 40.385087 52
cycle:  14 max_shift: 0.015665 LBFGS: function start/end, n_calls: 40.385087 40.348368 52
cycle:  15 max_shift: 0.055292 LBFGS: function start/end, n_calls: 40.348368 40.288293 52
cycle:  16 max_shift: 0.025481 LBFGS: function start/end, n_calls: 40.288293 40.241281 52
cycle:  17 max_shift: 0.011478 LBFGS: function start/end, n_calls: 40.241281 40.217995 52
cycle:  18 max_shift: 0.050102 LBFGS: function start/end, n_calls: 40.217995 40.172130 52
cycle:  19 max_shift: 0.009287 LBFGS: function start/end, n_calls: 40.172130 40.141765 52
cycle:  20 max_shift: 0.079777 LBFGS: function start/end, n_calls: 40.141765 40.086658 52
cycle:  21 max_shift: 0.008877 LBFGS: function start/end, n_calls: 40.086658 40.041076 52
cycle:  22 max_shift: 0.095554 LBFGS: function start/end, n_calls: 40.041076 39.983921 52
cycle:  23 max_shift: 0.010879 LBFGS: function start/end, n_calls: 39.983921 39.935478 52
cycle:  24 max_shift: 0.091127 LBFGS: function start/end, n_calls: 39.935478 39.883498 52
cycle:  25 max_shift: 0.009345 LBFGS: function start/end, n_calls: 39.883498 39.846933 52
cycle:  26 max_shift: 0.023998 LBFGS: function start/end, n_calls: 39.846933 39.833116 52
cycle:  27 max_shift: 0.006188 LBFGS: function start/end, n_calls: 39.833116 39.823589 52
cycle:  28 max_shift: 0.016639 LBFGS: function start/end, n_calls: 39.823589 39.814125 52
cycle:  29 max_shift: 0.010341 LBFGS: function start/end, n_calls: 39.814125 39.805789 52
cycle:  30 max_shift: 0.006087 LBFGS: function start/end, n_calls: 39.805789 39.799617 52
cycle:  31 max_shift: 0.015902 LBFGS: function start/end, n_calls: 39.799617 39.792350 52
cycle:  32 max_shift: 0.005097 LBFGS: function start/end, n_calls: 39.792350 39.785124 52
cycle:  33 max_shift: 0.030231 LBFGS: function start/end, n_calls: 39.785124 39.774078 53
cycle:  34 max_shift: 0.006429 LBFGS: function start/end, n_calls: 39.774078 39.762010 52
cycle:  35 max_shift: 0.020239 LBFGS: function start/end, n_calls: 39.762010 39.753401 52
cycle:  36 max_shift: 0.005061 LBFGS: function start/end, n_calls: 39.753401 39.746788 52
cycle:  37 max_shift: 0.006471 LBFGS: function start/end, n_calls: 39.746788 39.743261 52
cycle:  38 max_shift: 0.005176 LBFGS: function start/end, n_calls: 39.743261 39.739554 52
cycle:  39 max_shift: 0.013786 LBFGS: function start/end, n_calls: 39.739554 39.734267 52
cycle:  40 max_shift: 0.004115 LBFGS: function start/end, n_calls: 39.734267 39.729071 52
cycle:  41 max_shift: 0.024522 LBFGS: function start/end, n_calls: 39.729071 39.720831 53
cycle:  42 max_shift: 0.004444 LBFGS: function start/end, n_calls: 39.720831 39.713472 52
cycle:  43 max_shift: 0.019779 LBFGS: function start/end, n_calls: 39.713472 39.707269 52
cycle:  44 max_shift: 0.003765 LBFGS: function start/end, n_calls: 39.707269 39.701414 52
cycle:  45 max_shift: 0.014608 LBFGS: function start/end, n_calls: 39.701414 39.697133 52
cycle:  46 max_shift: 0.003431 LBFGS: function start/end, n_calls: 39.697133 39.692649 52
cycle:  47 max_shift: 0.008731 LBFGS: function start/end, n_calls: 39.692649 39.689637 52
cycle:  48 max_shift: 0.002668 LBFGS: function start/end, n_calls: 39.689637 39.687005 52
cycle:  49 max_shift: 0.006915 LBFGS: function start/end, n_calls: 39.687005 39.684659 52
cycle:  50 max_shift: 0.002887 LBFGS: function start/end, n_calls: 39.684659 39.682289 52
cycle:  51 max_shift: 0.006606 LBFGS: function start/end, n_calls: 39.682289 39.680093 52
cycle:  52 max_shift: 0.003094 LBFGS: function start/end, n_calls: 39.680093 39.677901 53
cycle:  53 max_shift: 0.006749 LBFGS: function start/end, n_calls: 39.677901 39.675307 52
cycle:  54 max_shift: 0.005481 LBFGS: function start/end, n_calls: 39.675307 39.672876 52
cycle:  55 max_shift: 0.002537 LBFGS: function start/end, n_calls: 39.672876 39.670905 52
cycle:  56 max_shift: 0.008965 LBFGS: function start/end, n_calls: 39.670905 39.668399 52
cycle:  57 max_shift: 0.002552 LBFGS: function start/end, n_calls: 39.668399 39.665757 52
cycle:  58 max_shift: 0.067143 LBFGS: function start/end, n_calls: 39.665757 39.651529 52
cycle:  59 max_shift: 0.002978 LBFGS: function start/end, n_calls: 39.651529 39.638398 52
cycle:  60 max_shift: 0.011845 LBFGS: function start/end, n_calls: 39.638398 39.635995 52
cycle:  61 max_shift: 0.001608 LBFGS: function start/end, n_calls: 39.635995 39.633752 52
cycle:  62 max_shift: 0.003382 LBFGS: function start/end, n_calls: 39.633752 39.632880 52
cycle:  63 max_shift: 0.003287 LBFGS: function start/end, n_calls: 39.632880 39.631607 52
cycle:  64 max_shift: 0.009470 LBFGS: function start/end, n_calls: 39.631607 39.629178 52
cycle:  65 max_shift: 0.004396 LBFGS: function start/end, n_calls: 39.629178 39.627324 52
cycle:  66 max_shift: 0.024307 LBFGS: function start/end, n_calls: 39.627324 39.622993 52
cycle:  67 max_shift: 0.002438 LBFGS: function start/end, n_calls: 39.622993 39.618707 52
cycle:  68 max_shift: 0.014653 LBFGS: function start/end, n_calls: 39.618707 39.616209 52
cycle:  69 max_shift: 0.002029 LBFGS: function start/end, n_calls: 39.616209 39.613885 52
cycle:  70 max_shift: 0.009249 LBFGS: function start/end, n_calls: 39.613885 39.612462 52
cycle:  71 max_shift: 0.001668 LBFGS: function start/end, n_calls: 39.612462 39.610909 52
cycle:  72 max_shift: 0.002930 LBFGS: function start/end, n_calls: 39.610909 39.610304 52
cycle:  73 max_shift: 0.001348 LBFGS: function start/end, n_calls: 39.610304 39.609720 52
cycle:  74 max_shift: 0.002422 LBFGS: function start/end, n_calls: 39.609720 39.609248 53
cycle:  75 max_shift: 0.005008 LBFGS: function start/end, n_calls: 39.609248 39.608157 52
cycle:  76 max_shift: 0.001341 LBFGS: function start/end, n_calls: 39.608157 39.607346 52
cycle:  77 max_shift: 0.005311 LBFGS: function start/end, n_calls: 39.607346 39.606522 52
cycle:  78 max_shift: 0.001580 LBFGS: function start/end, n_calls: 39.606522 39.605616 52
cycle:  79 max_shift: 0.009404 LBFGS: function start/end, n_calls: 39.605616 39.604251 52
cycle:  80 max_shift: 0.002227 LBFGS: function start/end, n_calls: 39.604251 39.602765 52
cycle:  81 max_shift: 0.004377 LBFGS: function start/end, n_calls: 39.602765 39.602003 52
cycle:  82 max_shift: 0.002341 LBFGS: function start/end, n_calls: 39.602003 39.601111 52
cycle:  83 max_shift: 0.008847 LBFGS: function start/end, n_calls: 39.601111 39.599695 52
cycle:  84 max_shift: 0.002204 LBFGS: function start/end, n_calls: 39.599695 39.598355 52
cycle:  85 max_shift: 0.003623 LBFGS: function start/end, n_calls: 39.598355 39.597750 52
cycle:  86 max_shift: 0.001233 LBFGS: function start/end, n_calls: 39.597750 39.597171 52
cycle:  87 max_shift: 0.003590 LBFGS: function start/end, n_calls: 39.597171 39.596602 52
cycle:  88 max_shift: 0.001339 LBFGS: function start/end, n_calls: 39.596602 39.596054 52
cycle:  89 max_shift: 0.001476 LBFGS: function start/end, n_calls: 39.596054 39.595730 53
cycle:  90 max_shift: 0.009420 LBFGS: function start/end, n_calls: 39.595730 39.594545 52
cycle:  91 max_shift: 0.001318 LBFGS: function start/end, n_calls: 39.594545 39.593144 52
cycle:  92 max_shift: 0.002129 LBFGS: function start/end, n_calls: 39.593144 39.592789 53
cycle:  93 max_shift: 0.001834 LBFGS: function start/end, n_calls: 39.592789 39.592327 52
cycle:  94 max_shift: 0.000928 LBFGS: function start/end, n_calls: 39.592327 39.591988 53
cycle:  95 max_shift: 0.001938 LBFGS: function start/end, n_calls: 39.591988 39.591674 52
cycle:  96 max_shift: 0.000837 LBFGS: function start/end, n_calls: 39.591674 39.591328 52
cycle:  97 max_shift: 0.003330 LBFGS: function start/end, n_calls: 39.591328 39.590875 52
cycle:  98 max_shift: 0.000980 LBFGS: function start/end, n_calls: 39.590875 39.590387 52
Convergence reached. Stopping now.
final: bond:  0.000 angle:   0.25 clash:   0.0 rota:  0.00 rama: f: 100.00 o:   0.00 Z:  -1.82 cb:   0.00
See 4_refined.pdb in pdb folder.
Time: 5.1106
