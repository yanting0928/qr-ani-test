Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/0.9/pdb/2.rst.pickle
***********************************************************

start: bond:  0.013 angle:   1.30 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   0.00 Z:  -5.43 cb:   0.00
cycle:   0 max_shift: 0.184217 LBFGS: function start/end, n_calls: 286.278145 47.128827 52
cycle:   1 max_shift: 0.089990 LBFGS: function start/end, n_calls: 47.128827 43.836282 52
cycle:   2 max_shift: 0.072065 LBFGS: function start/end, n_calls: 43.836282 42.568552 52
cycle:   3 max_shift: 0.082412 LBFGS: function start/end, n_calls: 42.568552 42.069702 52
cycle:   4 max_shift: 0.020031 LBFGS: function start/end, n_calls: 42.069702 41.874478 52
cycle:   5 max_shift: 0.064355 LBFGS: function start/end, n_calls: 41.874478 41.723123 53
cycle:   6 max_shift: 0.015349 LBFGS: function start/end, n_calls: 41.723123 41.603302 53
cycle:   7 max_shift: 0.040354 LBFGS: function start/end, n_calls: 41.603302 41.519583 54
cycle:   8 max_shift: 0.015523 LBFGS: function start/end, n_calls: 41.519583 41.446219 53
cycle:   9 max_shift: 0.062895 LBFGS: function start/end, n_calls: 41.446219 41.311220 52
cycle:  10 max_shift: 0.028741 LBFGS: function start/end, n_calls: 41.311220 41.192468 52
cycle:  11 max_shift: 0.061183 LBFGS: function start/end, n_calls: 41.192468 41.073770 52
cycle:  12 max_shift: 0.019842 LBFGS: function start/end, n_calls: 41.073770 40.973041 52
cycle:  13 max_shift: 0.036342 LBFGS: function start/end, n_calls: 40.973041 40.917598 53
cycle:  14 max_shift: 0.091702 LBFGS: function start/end, n_calls: 40.917598 40.776779 52
cycle:  15 max_shift: 0.022677 LBFGS: function start/end, n_calls: 40.776779 40.649386 52
cycle:  16 max_shift: 0.080093 LBFGS: function start/end, n_calls: 40.649386 40.492373 52
cycle:  17 max_shift: 0.014707 LBFGS: function start/end, n_calls: 40.492373 40.417509 52
cycle:  18 max_shift: 0.034497 LBFGS: function start/end, n_calls: 40.417509 40.345770 52
cycle:  19 max_shift: 0.011087 LBFGS: function start/end, n_calls: 40.345770 40.297490 52
cycle:  20 max_shift: 0.033588 LBFGS: function start/end, n_calls: 40.297490 40.233642 52
cycle:  21 max_shift: 0.009545 LBFGS: function start/end, n_calls: 40.233642 40.191139 52
cycle:  22 max_shift: 0.022226 LBFGS: function start/end, n_calls: 40.191139 40.153372 52
cycle:  23 max_shift: 0.009121 LBFGS: function start/end, n_calls: 40.153372 40.127755 53
cycle:  24 max_shift: 0.060594 LBFGS: function start/end, n_calls: 40.127755 40.051251 52
cycle:  25 max_shift: 0.010581 LBFGS: function start/end, n_calls: 40.051251 39.996658 52
cycle:  26 max_shift: 0.089444 LBFGS: function start/end, n_calls: 39.996658 39.896610 52
cycle:  27 max_shift: 0.007881 LBFGS: function start/end, n_calls: 39.896610 39.852574 53
cycle:  28 max_shift: 0.076641 LBFGS: function start/end, n_calls: 39.852574 39.786730 53
cycle:  29 max_shift: 0.006817 LBFGS: function start/end, n_calls: 39.786730 39.757742 52
cycle:  30 max_shift: 0.017827 LBFGS: function start/end, n_calls: 39.757742 39.746254 52
cycle:  31 max_shift: 0.006567 LBFGS: function start/end, n_calls: 39.746254 39.737169 52
cycle:  32 max_shift: 0.010049 LBFGS: function start/end, n_calls: 39.737169 39.730530 52
cycle:  33 max_shift: 0.005116 LBFGS: function start/end, n_calls: 39.730530 39.725036 52
cycle:  34 max_shift: 0.006465 LBFGS: function start/end, n_calls: 39.725036 39.721008 53
cycle:  35 max_shift: 0.003971 LBFGS: function start/end, n_calls: 39.721008 39.716895 52
cycle:  36 max_shift: 0.012378 LBFGS: function start/end, n_calls: 39.716895 39.710434 52
cycle:  37 max_shift: 0.003809 LBFGS: function start/end, n_calls: 39.710434 39.704327 52
cycle:  38 max_shift: 0.025969 LBFGS: function start/end, n_calls: 39.704327 39.693248 52
cycle:  39 max_shift: 0.005308 LBFGS: function start/end, n_calls: 39.693248 39.684546 52
cycle:  40 max_shift: 0.004716 LBFGS: function start/end, n_calls: 39.684546 39.682231 52
cycle:  41 max_shift: 0.002481 LBFGS: function start/end, n_calls: 39.682231 39.679598 53
cycle:  42 max_shift: 0.026103 LBFGS: function start/end, n_calls: 39.679598 39.668665 52
cycle:  43 max_shift: 0.004899 LBFGS: function start/end, n_calls: 39.668665 39.660727 52
cycle:  44 max_shift: 0.005803 LBFGS: function start/end, n_calls: 39.660727 39.657993 52
cycle:  45 max_shift: 0.002503 LBFGS: function start/end, n_calls: 39.657993 39.655644 52
cycle:  46 max_shift: 0.003285 LBFGS: function start/end, n_calls: 39.655644 39.654388 53
cycle:  47 max_shift: 0.003009 LBFGS: function start/end, n_calls: 39.654388 39.652743 52
cycle:  48 max_shift: 0.003488 LBFGS: function start/end, n_calls: 39.652743 39.650982 52
cycle:  49 max_shift: 0.002223 LBFGS: function start/end, n_calls: 39.650982 39.649311 52
cycle:  50 max_shift: 0.006706 LBFGS: function start/end, n_calls: 39.649311 39.646622 52
cycle:  51 max_shift: 0.001899 LBFGS: function start/end, n_calls: 39.646622 39.644025 52
cycle:  52 max_shift: 0.005124 LBFGS: function start/end, n_calls: 39.644025 39.642233 52
cycle:  53 max_shift: 0.001943 LBFGS: function start/end, n_calls: 39.642233 39.640066 52
cycle:  54 max_shift: 0.012705 LBFGS: function start/end, n_calls: 39.640066 39.635871 52
cycle:  55 max_shift: 0.002650 LBFGS: function start/end, n_calls: 39.635871 39.631867 52
cycle:  56 max_shift: 0.025017 LBFGS: function start/end, n_calls: 39.631867 39.625216 52
cycle:  57 max_shift: 0.004416 LBFGS: function start/end, n_calls: 39.625216 39.618026 52
cycle:  58 max_shift: 0.008860 LBFGS: function start/end, n_calls: 39.618026 39.615555 52
cycle:  59 max_shift: 0.002111 LBFGS: function start/end, n_calls: 39.615555 39.613298 52
cycle:  60 max_shift: 0.014730 LBFGS: function start/end, n_calls: 39.613298 39.609334 52
cycle:  61 max_shift: 0.001950 LBFGS: function start/end, n_calls: 39.609334 39.605995 52
cycle:  62 max_shift: 0.002685 LBFGS: function start/end, n_calls: 39.605995 39.605306 52
cycle:  63 max_shift: 0.002309 LBFGS: function start/end, n_calls: 39.605306 39.604616 53
cycle:  64 max_shift: 0.002009 LBFGS: function start/end, n_calls: 39.604616 39.604036 52
cycle:  65 max_shift: 0.002192 LBFGS: function start/end, n_calls: 39.604036 39.603371 52
cycle:  66 max_shift: 0.001478 LBFGS: function start/end, n_calls: 39.603371 39.602806 52
cycle:  67 max_shift: 0.001955 LBFGS: function start/end, n_calls: 39.602806 39.602263 52
cycle:  68 max_shift: 0.001954 LBFGS: function start/end, n_calls: 39.602263 39.601609 52
cycle:  69 max_shift: 0.002479 LBFGS: function start/end, n_calls: 39.601609 39.600901 52
cycle:  70 max_shift: 0.001358 LBFGS: function start/end, n_calls: 39.600901 39.600366 52
cycle:  71 max_shift: 0.003398 LBFGS: function start/end, n_calls: 39.600366 39.599637 52
cycle:  72 max_shift: 0.001594 LBFGS: function start/end, n_calls: 39.599637 39.598773 52
cycle:  73 max_shift: 0.002929 LBFGS: function start/end, n_calls: 39.598773 39.598202 52
cycle:  74 max_shift: 0.001944 LBFGS: function start/end, n_calls: 39.598202 39.597534 53
cycle:  75 max_shift: 0.002104 LBFGS: function start/end, n_calls: 39.597534 39.597026 52
cycle:  76 max_shift: 0.001440 LBFGS: function start/end, n_calls: 39.597026 39.596538 53
cycle:  77 max_shift: 0.004194 LBFGS: function start/end, n_calls: 39.596538 39.595552 52
cycle:  78 max_shift: 0.001409 LBFGS: function start/end, n_calls: 39.595552 39.594567 53
cycle:  79 max_shift: 0.002769 LBFGS: function start/end, n_calls: 39.594567 39.594053 52
cycle:  80 max_shift: 0.001433 LBFGS: function start/end, n_calls: 39.594053 39.593479 52
cycle:  81 max_shift: 0.003109 LBFGS: function start/end, n_calls: 39.593479 39.592868 52
cycle:  82 max_shift: 0.001583 LBFGS: function start/end, n_calls: 39.592868 39.592207 52
cycle:  83 max_shift: 0.006159 LBFGS: function start/end, n_calls: 39.592207 39.590941 52
cycle:  84 max_shift: 0.002148 LBFGS: function start/end, n_calls: 39.590941 39.589631 52
cycle:  85 max_shift: 0.009102 LBFGS: function start/end, n_calls: 39.589631 39.588128 52
cycle:  86 max_shift: 0.003331 LBFGS: function start/end, n_calls: 39.588128 39.586263 52
cycle:  87 max_shift: 0.010683 LBFGS: function start/end, n_calls: 39.586263 39.584451 52
cycle:  88 max_shift: 0.001015 LBFGS: function start/end, n_calls: 39.584451 39.582394 52
cycle:  89 max_shift: 0.003331 LBFGS: function start/end, n_calls: 39.582394 39.581742 52
cycle:  90 max_shift: 0.001813 LBFGS: function start/end, n_calls: 39.581742 39.581020 52
cycle:  91 max_shift: 0.001929 LBFGS: function start/end, n_calls: 39.581020 39.580605 52
cycle:  92 max_shift: 0.001451 LBFGS: function start/end, n_calls: 39.580605 39.580188 52
cycle:  93 max_shift: 0.001066 LBFGS: function start/end, n_calls: 39.580188 39.579925 52
cycle:  94 max_shift: 0.001516 LBFGS: function start/end, n_calls: 39.579925 39.579660 52
cycle:  95 max_shift: 0.006416 LBFGS: function start/end, n_calls: 39.579660 39.578563 52
cycle:  96 max_shift: 0.001602 LBFGS: function start/end, n_calls: 39.578563 39.577350 52
cycle:  97 max_shift: 0.006881 LBFGS: function start/end, n_calls: 39.577350 39.576180 52
cycle:  98 max_shift: 0.002139 LBFGS: function start/end, n_calls: 39.576180 39.575067 52
cycle:  99 max_shift: 0.009363 LBFGS: function start/end, n_calls: 39.575067 39.573627 52
final: bond:  0.000 angle:   0.25 clash:   0.0 rota:  0.00 rama: f: 100.00 o:   0.00 Z:  -2.50 cb:   0.00
See 2_refined.pdb in pdb folder.
Time: 5.1165
