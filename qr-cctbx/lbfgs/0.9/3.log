Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/0.9/pdb/3.rst.pickle
***********************************************************

start: bond:  0.012 angle:   1.48 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   0.00 Z:  -5.46 cb:   0.00
cycle:   0 max_shift: 0.192566 LBFGS: function start/end, n_calls: 279.583367 50.938587 52
cycle:   1 max_shift: 0.197964 LBFGS: function start/end, n_calls: 50.938587 46.114044 52
cycle:   2 max_shift: 0.075697 LBFGS: function start/end, n_calls: 46.114044 44.401683 52
cycle:   3 max_shift: 0.060192 LBFGS: function start/end, n_calls: 44.401683 43.690488 52
cycle:   4 max_shift: 0.053961 LBFGS: function start/end, n_calls: 43.690488 43.105831 53
cycle:   5 max_shift: 0.069191 LBFGS: function start/end, n_calls: 43.105831 42.500752 53
cycle:   6 max_shift: 0.171268 LBFGS: function start/end, n_calls: 42.500752 41.436884 52
cycle:   7 max_shift: 0.031444 LBFGS: function start/end, n_calls: 41.436884 41.002606 52
cycle:   8 max_shift: 0.088203 LBFGS: function start/end, n_calls: 41.002606 40.662656 53
cycle:   9 max_shift: 0.018952 LBFGS: function start/end, n_calls: 40.662656 40.483642 52
cycle:  10 max_shift: 0.080897 LBFGS: function start/end, n_calls: 40.483642 40.321896 52
cycle:  11 max_shift: 0.008792 LBFGS: function start/end, n_calls: 40.321896 40.225525 52
cycle:  12 max_shift: 0.108941 LBFGS: function start/end, n_calls: 40.225525 40.109076 52
cycle:  13 max_shift: 0.017516 LBFGS: function start/end, n_calls: 40.109076 40.008596 52
cycle:  14 max_shift: 0.062862 LBFGS: function start/end, n_calls: 40.008596 39.952000 52
cycle:  15 max_shift: 0.011314 LBFGS: function start/end, n_calls: 39.952000 39.911299 52
cycle:  16 max_shift: 0.012642 LBFGS: function start/end, n_calls: 39.911299 39.891997 52
cycle:  17 max_shift: 0.009002 LBFGS: function start/end, n_calls: 39.891997 39.877540 52
cycle:  18 max_shift: 0.006152 LBFGS: function start/end, n_calls: 39.877540 39.868125 52
cycle:  19 max_shift: 0.010954 LBFGS: function start/end, n_calls: 39.868125 39.855359 52
cycle:  20 max_shift: 0.013993 LBFGS: function start/end, n_calls: 39.855359 39.840555 52
cycle:  21 max_shift: 0.006041 LBFGS: function start/end, n_calls: 39.840555 39.830086 52
cycle:  22 max_shift: 0.016178 LBFGS: function start/end, n_calls: 39.830086 39.819007 52
cycle:  23 max_shift: 0.006004 LBFGS: function start/end, n_calls: 39.819007 39.807761 52
cycle:  24 max_shift: 0.104786 LBFGS: function start/end, n_calls: 39.807761 39.746630 52
cycle:  25 max_shift: 0.007734 LBFGS: function start/end, n_calls: 39.746630 39.717519 52
cycle:  26 max_shift: 0.004397 LBFGS: function start/end, n_calls: 39.717519 39.714370 52
cycle:  27 max_shift: 0.003814 LBFGS: function start/end, n_calls: 39.714370 39.712456 53
cycle:  28 max_shift: 0.003421 LBFGS: function start/end, n_calls: 39.712456 39.710680 52
cycle:  29 max_shift: 0.003161 LBFGS: function start/end, n_calls: 39.710680 39.709142 52
cycle:  30 max_shift: 0.003780 LBFGS: function start/end, n_calls: 39.709142 39.707250 52
cycle:  31 max_shift: 0.006383 LBFGS: function start/end, n_calls: 39.707250 39.705123 52
cycle:  32 max_shift: 0.002110 LBFGS: function start/end, n_calls: 39.705123 39.703113 52
cycle:  33 max_shift: 0.012648 LBFGS: function start/end, n_calls: 39.703113 39.699536 52
cycle:  34 max_shift: 0.002854 LBFGS: function start/end, n_calls: 39.699536 39.696478 52
cycle:  35 max_shift: 0.005128 LBFGS: function start/end, n_calls: 39.696478 39.694787 52
cycle:  36 max_shift: 0.003041 LBFGS: function start/end, n_calls: 39.694787 39.693109 52
cycle:  37 max_shift: 0.003165 LBFGS: function start/end, n_calls: 39.693109 39.691905 54
cycle:  38 max_shift: 0.002488 LBFGS: function start/end, n_calls: 39.691905 39.690696 52
cycle:  39 max_shift: 0.005952 LBFGS: function start/end, n_calls: 39.690696 39.688921 52
cycle:  40 max_shift: 0.001633 LBFGS: function start/end, n_calls: 39.688921 39.687595 53
cycle:  41 max_shift: 0.002348 LBFGS: function start/end, n_calls: 39.687595 39.686870 54
cycle:  42 max_shift: 0.059454 LBFGS: function start/end, n_calls: 39.686870 39.677262 52
cycle:  43 max_shift: 0.003432 LBFGS: function start/end, n_calls: 39.677262 39.666697 53
cycle:  44 max_shift: 0.008102 LBFGS: function start/end, n_calls: 39.666697 39.665154 52
cycle:  45 max_shift: 0.001562 LBFGS: function start/end, n_calls: 39.665154 39.663765 52
cycle:  46 max_shift: 0.013934 LBFGS: function start/end, n_calls: 39.663765 39.661688 52
cycle:  47 max_shift: 0.001744 LBFGS: function start/end, n_calls: 39.661688 39.659599 52
cycle:  48 max_shift: 0.006298 LBFGS: function start/end, n_calls: 39.659599 39.658748 52
cycle:  49 max_shift: 0.001240 LBFGS: function start/end, n_calls: 39.658748 39.657680 52
cycle:  50 max_shift: 0.005948 LBFGS: function start/end, n_calls: 39.657680 39.656828 52
cycle:  51 max_shift: 0.001398 LBFGS: function start/end, n_calls: 39.656828 39.655842 52
cycle:  52 max_shift: 0.002856 LBFGS: function start/end, n_calls: 39.655842 39.655338 52
cycle:  53 max_shift: 0.001786 LBFGS: function start/end, n_calls: 39.655338 39.654786 52
cycle:  54 max_shift: 0.001563 LBFGS: function start/end, n_calls: 39.654786 39.654357 52
cycle:  55 max_shift: 0.001837 LBFGS: function start/end, n_calls: 39.654357 39.653942 52
cycle:  56 max_shift: 0.001100 LBFGS: function start/end, n_calls: 39.653942 39.653598 53
cycle:  57 max_shift: 0.002954 LBFGS: function start/end, n_calls: 39.653598 39.653170 52
cycle:  58 max_shift: 0.001358 LBFGS: function start/end, n_calls: 39.653170 39.652593 52
cycle:  59 max_shift: 0.002037 LBFGS: function start/end, n_calls: 39.652593 39.652177 52
cycle:  60 max_shift: 0.001191 LBFGS: function start/end, n_calls: 39.652177 39.651803 52
cycle:  61 max_shift: 0.003210 LBFGS: function start/end, n_calls: 39.651803 39.651327 52
cycle:  62 max_shift: 0.001459 LBFGS: function start/end, n_calls: 39.651327 39.650739 52
cycle:  63 max_shift: 0.007252 LBFGS: function start/end, n_calls: 39.650739 39.649725 52
cycle:  64 max_shift: 0.001301 LBFGS: function start/end, n_calls: 39.649725 39.648841 52
cycle:  65 max_shift: 0.011105 LBFGS: function start/end, n_calls: 39.648841 39.647604 52
cycle:  66 max_shift: 0.001585 LBFGS: function start/end, n_calls: 39.647604 39.646251 52
cycle:  67 max_shift: 0.004613 LBFGS: function start/end, n_calls: 39.646251 39.645740 52
cycle:  68 max_shift: 0.001977 LBFGS: function start/end, n_calls: 39.645740 39.644958 52
cycle:  69 max_shift: 0.003251 LBFGS: function start/end, n_calls: 39.644958 39.644507 52
cycle:  70 max_shift: 0.000969 LBFGS: function start/end, n_calls: 39.644507 39.644069 53
cycle:  71 max_shift: 0.002134 LBFGS: function start/end, n_calls: 39.644069 39.643801 52
cycle:  72 max_shift: 0.000854 LBFGS: function start/end, n_calls: 39.643801 39.643503 52
cycle:  73 max_shift: 0.008808 LBFGS: function start/end, n_calls: 39.643503 39.642555 52
cycle:  74 max_shift: 0.001173 LBFGS: function start/end, n_calls: 39.642555 39.641627 52
cycle:  75 max_shift: 0.003010 LBFGS: function start/end, n_calls: 39.641627 39.641266 52
cycle:  76 max_shift: 0.000957 LBFGS: function start/end, n_calls: 39.641266 39.640919 52
Convergence reached. Stopping now.
final: bond:  0.000 angle:   0.26 clash:   0.0 rota:  0.00 rama: f: 100.00 o:   0.00 Z:  -0.74 cb:   0.00
See 3_refined.pdb in pdb folder.
Time: 4.8371
