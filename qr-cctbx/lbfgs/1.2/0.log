Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/1.2/pdb/0.rst.pickle
***********************************************************

start: bond:  0.013 angle:   1.30 clash:   0.0 rota:  0.00 rama: f: 100.00 o:   0.00 Z:  -5.08 cb:   0.00
cycle:   0 max_shift: 0.156713 LBFGS: function start/end, n_calls: 250.995460 48.441807 52
cycle:   1 max_shift: 0.125711 LBFGS: function start/end, n_calls: 48.441807 46.514332 52
cycle:   2 max_shift: 0.039305 LBFGS: function start/end, n_calls: 46.514332 45.803021 53
cycle:   3 max_shift: 0.309747 LBFGS: function start/end, n_calls: 45.803021 44.120869 52
cycle:   4 max_shift: 0.040619 LBFGS: function start/end, n_calls: 44.120869 43.385550 52
cycle:   5 max_shift: 0.272504 LBFGS: function start/end, n_calls: 43.385550 42.544773 52
cycle:   6 max_shift: 0.060911 LBFGS: function start/end, n_calls: 42.544773 42.054581 52
cycle:   7 max_shift: 0.022895 LBFGS: function start/end, n_calls: 42.054581 41.932732 53
cycle:   8 max_shift: 0.052281 LBFGS: function start/end, n_calls: 41.932732 41.758509 52
cycle:   9 max_shift: 0.015653 LBFGS: function start/end, n_calls: 41.758509 41.631516 52
cycle:  10 max_shift: 0.151151 LBFGS: function start/end, n_calls: 41.631516 41.247603 52
cycle:  11 max_shift: 0.021848 LBFGS: function start/end, n_calls: 41.247603 41.006010 52
cycle:  12 max_shift: 0.153134 LBFGS: function start/end, n_calls: 41.006010 40.791539 52
cycle:  13 max_shift: 0.015892 LBFGS: function start/end, n_calls: 40.791539 40.666882 53
cycle:  14 max_shift: 0.038775 LBFGS: function start/end, n_calls: 40.666882 40.617397 53
cycle:  15 max_shift: 0.013118 LBFGS: function start/end, n_calls: 40.617397 40.564596 52
cycle:  16 max_shift: 0.022998 LBFGS: function start/end, n_calls: 40.564596 40.529611 52
cycle:  17 max_shift: 0.017381 LBFGS: function start/end, n_calls: 40.529611 40.493948 52
cycle:  18 max_shift: 0.025944 LBFGS: function start/end, n_calls: 40.493948 40.457489 52
cycle:  19 max_shift: 0.015532 LBFGS: function start/end, n_calls: 40.457489 40.420779 52
cycle:  20 max_shift: 0.034500 LBFGS: function start/end, n_calls: 40.420779 40.383928 52
cycle:  21 max_shift: 0.012643 LBFGS: function start/end, n_calls: 40.383928 40.349259 52
cycle:  22 max_shift: 0.037960 LBFGS: function start/end, n_calls: 40.349259 40.317681 52
cycle:  23 max_shift: 0.015140 LBFGS: function start/end, n_calls: 40.317681 40.283127 52
cycle:  24 max_shift: 0.050650 LBFGS: function start/end, n_calls: 40.283127 40.242894 52
cycle:  25 max_shift: 0.015939 LBFGS: function start/end, n_calls: 40.242894 40.208448 52
cycle:  26 max_shift: 0.038554 LBFGS: function start/end, n_calls: 40.208448 40.182970 53
cycle:  27 max_shift: 0.017206 LBFGS: function start/end, n_calls: 40.182970 40.155705 52
cycle:  28 max_shift: 0.015853 LBFGS: function start/end, n_calls: 40.155705 40.141908 53
cycle:  29 max_shift: 0.011074 LBFGS: function start/end, n_calls: 40.141908 40.127431 52
cycle:  30 max_shift: 0.019665 LBFGS: function start/end, n_calls: 40.127431 40.112568 52
cycle:  31 max_shift: 0.010333 LBFGS: function start/end, n_calls: 40.112568 40.098123 52
cycle:  32 max_shift: 0.024026 LBFGS: function start/end, n_calls: 40.098123 40.081255 52
cycle:  33 max_shift: 0.009479 LBFGS: function start/end, n_calls: 40.081255 40.066458 52
cycle:  34 max_shift: 0.164840 LBFGS: function start/end, n_calls: 40.066458 39.985223 52
cycle:  35 max_shift: 0.019601 LBFGS: function start/end, n_calls: 39.985223 39.941127 52
cycle:  36 max_shift: 0.013841 LBFGS: function start/end, n_calls: 39.941127 39.936458 54
cycle:  37 max_shift: 0.006958 LBFGS: function start/end, n_calls: 39.936458 39.930923 52
cycle:  38 max_shift: 0.021526 LBFGS: function start/end, n_calls: 39.930923 39.924532 52
cycle:  39 max_shift: 0.006431 LBFGS: function start/end, n_calls: 39.924532 39.918708 52
cycle:  40 max_shift: 0.014488 LBFGS: function start/end, n_calls: 39.918708 39.913767 52
cycle:  41 max_shift: 0.004607 LBFGS: function start/end, n_calls: 39.913767 39.909484 52
cycle:  42 max_shift: 0.006669 LBFGS: function start/end, n_calls: 39.909484 39.907326 52
cycle:  43 max_shift: 0.004706 LBFGS: function start/end, n_calls: 39.907326 39.905304 52
cycle:  44 max_shift: 0.007674 LBFGS: function start/end, n_calls: 39.905304 39.902918 52
cycle:  45 max_shift: 0.004857 LBFGS: function start/end, n_calls: 39.902918 39.900464 52
cycle:  46 max_shift: 0.005607 LBFGS: function start/end, n_calls: 39.900464 39.898171 52
cycle:  47 max_shift: 0.007872 LBFGS: function start/end, n_calls: 39.898171 39.895289 52
cycle:  48 max_shift: 0.004158 LBFGS: function start/end, n_calls: 39.895289 39.892248 52
cycle:  49 max_shift: 0.050739 LBFGS: function start/end, n_calls: 39.892248 39.879618 52
cycle:  50 max_shift: 0.006396 LBFGS: function start/end, n_calls: 39.879618 39.867505 52
cycle:  51 max_shift: 0.024396 LBFGS: function start/end, n_calls: 39.867505 39.860886 52
cycle:  52 max_shift: 0.002766 LBFGS: function start/end, n_calls: 39.860886 39.854545 52
cycle:  53 max_shift: 0.014120 LBFGS: function start/end, n_calls: 39.854545 39.850028 52
cycle:  54 max_shift: 0.001909 LBFGS: function start/end, n_calls: 39.850028 39.846999 52
cycle:  55 max_shift: 0.005118 LBFGS: function start/end, n_calls: 39.846999 39.845573 52
cycle:  56 max_shift: 0.005382 LBFGS: function start/end, n_calls: 39.845573 39.843481 52
cycle:  57 max_shift: 0.001876 LBFGS: function start/end, n_calls: 39.843481 39.842282 52
cycle:  58 max_shift: 0.008109 LBFGS: function start/end, n_calls: 39.842282 39.840197 52
cycle:  59 max_shift: 0.002349 LBFGS: function start/end, n_calls: 39.840197 39.838298 52
cycle:  60 max_shift: 0.005591 LBFGS: function start/end, n_calls: 39.838298 39.836995 52
cycle:  61 max_shift: 0.002042 LBFGS: function start/end, n_calls: 39.836995 39.835638 53
cycle:  62 max_shift: 0.002678 LBFGS: function start/end, n_calls: 39.835638 39.834939 52
cycle:  63 max_shift: 0.001830 LBFGS: function start/end, n_calls: 39.834939 39.834005 52
cycle:  64 max_shift: 0.002535 LBFGS: function start/end, n_calls: 39.834005 39.833225 52
cycle:  65 max_shift: 0.001697 LBFGS: function start/end, n_calls: 39.833225 39.832467 52
cycle:  66 max_shift: 0.007435 LBFGS: function start/end, n_calls: 39.832467 39.830735 52
cycle:  67 max_shift: 0.003093 LBFGS: function start/end, n_calls: 39.830735 39.829110 52
cycle:  68 max_shift: 0.006319 LBFGS: function start/end, n_calls: 39.829110 39.827644 52
cycle:  69 max_shift: 0.003458 LBFGS: function start/end, n_calls: 39.827644 39.826465 53
cycle:  70 max_shift: 0.004457 LBFGS: function start/end, n_calls: 39.826465 39.825479 52
cycle:  71 max_shift: 0.002407 LBFGS: function start/end, n_calls: 39.825479 39.824473 52
cycle:  72 max_shift: 0.007478 LBFGS: function start/end, n_calls: 39.824473 39.822922 52
cycle:  73 max_shift: 0.003865 LBFGS: function start/end, n_calls: 39.822922 39.821345 52
cycle:  74 max_shift: 0.004052 LBFGS: function start/end, n_calls: 39.821345 39.820538 53
cycle:  75 max_shift: 0.003463 LBFGS: function start/end, n_calls: 39.820538 39.819472 52
cycle:  76 max_shift: 0.002084 LBFGS: function start/end, n_calls: 39.819472 39.818870 52
cycle:  77 max_shift: 0.002740 LBFGS: function start/end, n_calls: 39.818870 39.818010 52
cycle:  78 max_shift: 0.002600 LBFGS: function start/end, n_calls: 39.818010 39.817304 52
cycle:  79 max_shift: 0.002500 LBFGS: function start/end, n_calls: 39.817304 39.816708 52
cycle:  80 max_shift: 0.002465 LBFGS: function start/end, n_calls: 39.816708 39.816107 52
cycle:  81 max_shift: 0.002621 LBFGS: function start/end, n_calls: 39.816107 39.815483 52
cycle:  82 max_shift: 0.002161 LBFGS: function start/end, n_calls: 39.815483 39.814921 52
cycle:  83 max_shift: 0.002295 LBFGS: function start/end, n_calls: 39.814921 39.814424 52
cycle:  84 max_shift: 0.002400 LBFGS: function start/end, n_calls: 39.814424 39.813893 52
cycle:  85 max_shift: 0.002024 LBFGS: function start/end, n_calls: 39.813893 39.813266 52
cycle:  86 max_shift: 0.003393 LBFGS: function start/end, n_calls: 39.813266 39.812509 52
cycle:  87 max_shift: 0.002528 LBFGS: function start/end, n_calls: 39.812509 39.811835 53
cycle:  88 max_shift: 0.003778 LBFGS: function start/end, n_calls: 39.811835 39.811095 52
cycle:  89 max_shift: 0.002498 LBFGS: function start/end, n_calls: 39.811095 39.810319 52
cycle:  90 max_shift: 0.003077 LBFGS: function start/end, n_calls: 39.810319 39.809736 53
cycle:  91 max_shift: 0.002319 LBFGS: function start/end, n_calls: 39.809736 39.808978 52
cycle:  92 max_shift: 0.007306 LBFGS: function start/end, n_calls: 39.808978 39.807514 52
cycle:  93 max_shift: 0.003431 LBFGS: function start/end, n_calls: 39.807514 39.806220 52
cycle:  94 max_shift: 0.004345 LBFGS: function start/end, n_calls: 39.806220 39.805438 52
cycle:  95 max_shift: 0.002616 LBFGS: function start/end, n_calls: 39.805438 39.804422 52
cycle:  96 max_shift: 0.003145 LBFGS: function start/end, n_calls: 39.804422 39.803831 52
cycle:  97 max_shift: 0.002371 LBFGS: function start/end, n_calls: 39.803831 39.803213 52
cycle:  98 max_shift: 0.005676 LBFGS: function start/end, n_calls: 39.803213 39.802076 52
cycle:  99 max_shift: 0.002674 LBFGS: function start/end, n_calls: 39.802076 39.801116 52
final: bond:  0.000 angle:   0.25 clash:   0.0 rota:  0.00 rama: f:  81.82 o:   0.00 Z:  -5.69 cb:   0.00
See 0_refined.pdb in pdb folder.
Time: 5.0094
