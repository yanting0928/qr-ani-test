Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/1.2/pdb/8.rst.pickle
***********************************************************

start: bond:  0.013 angle:   1.38 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   0.00 Z:  -4.75 cb:   0.00
cycle:   0 max_shift: 0.192285 LBFGS: function start/end, n_calls: 275.705881 47.318259 52
cycle:   1 max_shift: 0.091661 LBFGS: function start/end, n_calls: 47.318259 44.604578 53
cycle:   2 max_shift: 0.079285 LBFGS: function start/end, n_calls: 44.604578 43.072523 52
cycle:   3 max_shift: 0.040293 LBFGS: function start/end, n_calls: 43.072523 42.590515 53
cycle:   4 max_shift: 0.058362 LBFGS: function start/end, n_calls: 42.590515 42.215256 52
cycle:   5 max_shift: 0.017084 LBFGS: function start/end, n_calls: 42.215256 42.104365 52
cycle:   6 max_shift: 0.079386 LBFGS: function start/end, n_calls: 42.104365 41.921135 52
cycle:   7 max_shift: 0.011020 LBFGS: function start/end, n_calls: 41.921135 41.855549 52
cycle:   8 max_shift: 0.079871 LBFGS: function start/end, n_calls: 41.855549 41.759181 52
cycle:   9 max_shift: 0.011586 LBFGS: function start/end, n_calls: 41.759181 41.689658 52
cycle:  10 max_shift: 0.064328 LBFGS: function start/end, n_calls: 41.689658 41.583960 52
cycle:  11 max_shift: 0.021134 LBFGS: function start/end, n_calls: 41.583960 41.509662 52
cycle:  12 max_shift: 0.012383 LBFGS: function start/end, n_calls: 41.509662 41.475435 53
cycle:  13 max_shift: 0.054092 LBFGS: function start/end, n_calls: 41.475435 41.389456 52
cycle:  14 max_shift: 0.010664 LBFGS: function start/end, n_calls: 41.389456 41.330913 53
cycle:  15 max_shift: 0.100525 LBFGS: function start/end, n_calls: 41.330913 41.187685 52
cycle:  16 max_shift: 0.017499 LBFGS: function start/end, n_calls: 41.187685 41.059468 52
cycle:  17 max_shift: 0.060560 LBFGS: function start/end, n_calls: 41.059468 40.963750 52
cycle:  18 max_shift: 0.011305 LBFGS: function start/end, n_calls: 40.963750 40.903629 52
cycle:  19 max_shift: 0.039648 LBFGS: function start/end, n_calls: 40.903629 40.855303 52
cycle:  20 max_shift: 0.010245 LBFGS: function start/end, n_calls: 40.855303 40.812153 52
cycle:  21 max_shift: 0.018278 LBFGS: function start/end, n_calls: 40.812153 40.783458 52
cycle:  22 max_shift: 0.010589 LBFGS: function start/end, n_calls: 40.783458 40.757014 52
cycle:  23 max_shift: 0.019163 LBFGS: function start/end, n_calls: 40.757014 40.726154 52
cycle:  24 max_shift: 0.013356 LBFGS: function start/end, n_calls: 40.726154 40.699849 52
cycle:  25 max_shift: 0.009506 LBFGS: function start/end, n_calls: 40.699849 40.679969 52
cycle:  26 max_shift: 0.011978 LBFGS: function start/end, n_calls: 40.679969 40.660872 52
cycle:  27 max_shift: 0.020602 LBFGS: function start/end, n_calls: 40.660872 40.630186 52
cycle:  28 max_shift: 0.014689 LBFGS: function start/end, n_calls: 40.630186 40.601387 52
cycle:  29 max_shift: 0.008700 LBFGS: function start/end, n_calls: 40.601387 40.583910 52
cycle:  30 max_shift: 0.020893 LBFGS: function start/end, n_calls: 40.583910 40.559005 52
cycle:  31 max_shift: 0.007785 LBFGS: function start/end, n_calls: 40.559005 40.540703 52
cycle:  32 max_shift: 0.045737 LBFGS: function start/end, n_calls: 40.540703 40.495812 52
cycle:  33 max_shift: 0.006270 LBFGS: function start/end, n_calls: 40.495812 40.470719 53
cycle:  34 max_shift: 0.044882 LBFGS: function start/end, n_calls: 40.470719 40.438269 52
cycle:  35 max_shift: 0.007508 LBFGS: function start/end, n_calls: 40.438269 40.411660 52
cycle:  36 max_shift: 0.032625 LBFGS: function start/end, n_calls: 40.411660 40.390058 52
cycle:  37 max_shift: 0.006590 LBFGS: function start/end, n_calls: 40.390058 40.373372 52
cycle:  38 max_shift: 0.038051 LBFGS: function start/end, n_calls: 40.373372 40.353044 52
cycle:  39 max_shift: 0.006743 LBFGS: function start/end, n_calls: 40.353044 40.334252 52
cycle:  40 max_shift: 0.026814 LBFGS: function start/end, n_calls: 40.334252 40.317083 52
cycle:  41 max_shift: 0.009110 LBFGS: function start/end, n_calls: 40.317083 40.305851 53
cycle:  42 max_shift: 0.005146 LBFGS: function start/end, n_calls: 40.305851 40.299618 52
cycle:  43 max_shift: 0.009984 LBFGS: function start/end, n_calls: 40.299618 40.293607 52
cycle:  44 max_shift: 0.004370 LBFGS: function start/end, n_calls: 40.293607 40.288274 52
cycle:  45 max_shift: 0.020064 LBFGS: function start/end, n_calls: 40.288274 40.278015 52
cycle:  46 max_shift: 0.005073 LBFGS: function start/end, n_calls: 40.278015 40.268583 52
cycle:  47 max_shift: 0.011509 LBFGS: function start/end, n_calls: 40.268583 40.262617 52
cycle:  48 max_shift: 0.004528 LBFGS: function start/end, n_calls: 40.262617 40.257200 52
cycle:  49 max_shift: 0.008370 LBFGS: function start/end, n_calls: 40.257200 40.251751 52
cycle:  50 max_shift: 0.014946 LBFGS: function start/end, n_calls: 40.251751 40.242478 52
cycle:  51 max_shift: 0.005321 LBFGS: function start/end, n_calls: 40.242478 40.233419 52
cycle:  52 max_shift: 0.064235 LBFGS: function start/end, n_calls: 40.233419 40.203059 52
cycle:  53 max_shift: 0.009193 LBFGS: function start/end, n_calls: 40.203059 40.174772 52
cycle:  54 max_shift: 0.069721 LBFGS: function start/end, n_calls: 40.174772 40.137296 52
cycle:  55 max_shift: 0.005487 LBFGS: function start/end, n_calls: 40.137296 40.101965 52
cycle:  56 max_shift: 0.010926 LBFGS: function start/end, n_calls: 40.101965 40.096369 52
cycle:  57 max_shift: 0.002655 LBFGS: function start/end, n_calls: 40.096369 40.091642 52
cycle:  58 max_shift: 0.005668 LBFGS: function start/end, n_calls: 40.091642 40.087493 52
cycle:  59 max_shift: 0.002503 LBFGS: function start/end, n_calls: 40.087493 40.084692 53
cycle:  60 max_shift: 0.047787 LBFGS: function start/end, n_calls: 40.084692 40.065852 52
cycle:  61 max_shift: 0.008235 LBFGS: function start/end, n_calls: 40.065852 40.041191 52
cycle:  62 max_shift: 0.009756 LBFGS: function start/end, n_calls: 40.041191 40.036424 52
cycle:  63 max_shift: 0.003541 LBFGS: function start/end, n_calls: 40.036424 40.031869 52
cycle:  64 max_shift: 0.010033 LBFGS: function start/end, n_calls: 40.031869 40.027594 52
cycle:  65 max_shift: 0.004064 LBFGS: function start/end, n_calls: 40.027594 40.022465 52
cycle:  66 max_shift: 0.014527 LBFGS: function start/end, n_calls: 40.022465 40.015927 52
cycle:  67 max_shift: 0.004382 LBFGS: function start/end, n_calls: 40.015927 40.008785 52
cycle:  68 max_shift: 0.006240 LBFGS: function start/end, n_calls: 40.008785 40.005476 53
cycle:  69 max_shift: 0.003863 LBFGS: function start/end, n_calls: 40.005476 40.001664 52
cycle:  70 max_shift: 0.007426 LBFGS: function start/end, n_calls: 40.001664 39.997523 52
cycle:  71 max_shift: 0.002843 LBFGS: function start/end, n_calls: 39.997523 39.993905 52
cycle:  72 max_shift: 0.006978 LBFGS: function start/end, n_calls: 39.993905 39.990407 52
cycle:  73 max_shift: 0.002798 LBFGS: function start/end, n_calls: 39.990407 39.986514 52
cycle:  74 max_shift: 0.028304 LBFGS: function start/end, n_calls: 39.986514 39.974547 52
cycle:  75 max_shift: 0.003951 LBFGS: function start/end, n_calls: 39.974547 39.964533 52
cycle:  76 max_shift: 0.043322 LBFGS: function start/end, n_calls: 39.964533 39.949078 52
cycle:  77 max_shift: 0.006356 LBFGS: function start/end, n_calls: 39.949078 39.932230 52
cycle:  78 max_shift: 0.030479 LBFGS: function start/end, n_calls: 39.932230 39.921915 52
cycle:  79 max_shift: 0.005512 LBFGS: function start/end, n_calls: 39.921915 39.909946 52
cycle:  80 max_shift: 0.009541 LBFGS: function start/end, n_calls: 39.909946 39.905992 52
cycle:  81 max_shift: 0.003033 LBFGS: function start/end, n_calls: 39.905992 39.901538 52
cycle:  82 max_shift: 0.012552 LBFGS: function start/end, n_calls: 39.901538 39.895902 52
cycle:  83 max_shift: 0.002020 LBFGS: function start/end, n_calls: 39.895902 39.891328 52
cycle:  84 max_shift: 0.055057 LBFGS: function start/end, n_calls: 39.891328 39.872832 52
cycle:  85 max_shift: 0.007115 LBFGS: function start/end, n_calls: 39.872832 39.854413 52
cycle:  86 max_shift: 0.008151 LBFGS: function start/end, n_calls: 39.854413 39.851024 52
cycle:  87 max_shift: 0.003192 LBFGS: function start/end, n_calls: 39.851024 39.847806 52
cycle:  88 max_shift: 0.007599 LBFGS: function start/end, n_calls: 39.847806 39.844613 52
cycle:  89 max_shift: 0.003339 LBFGS: function start/end, n_calls: 39.844613 39.841541 52
cycle:  90 max_shift: 0.002918 LBFGS: function start/end, n_calls: 39.841541 39.839669 52
cycle:  91 max_shift: 0.004567 LBFGS: function start/end, n_calls: 39.839669 39.837402 52
cycle:  92 max_shift: 0.003002 LBFGS: function start/end, n_calls: 39.837402 39.835178 53
cycle:  93 max_shift: 0.004657 LBFGS: function start/end, n_calls: 39.835178 39.832689 52
cycle:  94 max_shift: 0.005031 LBFGS: function start/end, n_calls: 39.832689 39.829976 52
cycle:  95 max_shift: 0.003207 LBFGS: function start/end, n_calls: 39.829976 39.827965 53
cycle:  96 max_shift: 0.003850 LBFGS: function start/end, n_calls: 39.827965 39.826251 53
cycle:  97 max_shift: 0.002796 LBFGS: function start/end, n_calls: 39.826251 39.824463 52
cycle:  98 max_shift: 0.005167 LBFGS: function start/end, n_calls: 39.824463 39.822381 52
cycle:  99 max_shift: 0.002761 LBFGS: function start/end, n_calls: 39.822381 39.820376 52
final: bond:  0.000 angle:   0.25 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   0.00 Z:  -4.89 cb:   0.00
See 8_refined.pdb in pdb folder.
Time: 4.9553
