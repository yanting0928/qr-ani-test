Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = true
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = *lbfgs lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs/1.2/pdb/5.rst.pickle
***********************************************************

start: bond:  0.014 angle:   1.33 clash:   0.0 rota:  0.00 rama: f:  90.91 o:   0.00 Z:  -3.97 cb:   0.00
cycle:   0 max_shift: 0.254218 LBFGS: function start/end, n_calls: 252.724135 48.701708 52
cycle:   1 max_shift: 0.140994 LBFGS: function start/end, n_calls: 48.701708 44.823066 52
cycle:   2 max_shift: 0.033473 LBFGS: function start/end, n_calls: 44.823066 43.789009 52
cycle:   3 max_shift: 0.104855 LBFGS: function start/end, n_calls: 43.789009 42.854715 52
cycle:   4 max_shift: 0.033207 LBFGS: function start/end, n_calls: 42.854715 42.586534 52
cycle:   5 max_shift: 0.025982 LBFGS: function start/end, n_calls: 42.586534 42.464378 52
cycle:   6 max_shift: 0.022039 LBFGS: function start/end, n_calls: 42.464378 42.353223 53
cycle:   7 max_shift: 0.046349 LBFGS: function start/end, n_calls: 42.353223 42.185936 52
cycle:   8 max_shift: 0.016512 LBFGS: function start/end, n_calls: 42.185936 42.057205 52
cycle:   9 max_shift: 0.052099 LBFGS: function start/end, n_calls: 42.057205 41.881953 52
cycle:  10 max_shift: 0.018486 LBFGS: function start/end, n_calls: 41.881953 41.773074 52
cycle:  11 max_shift: 0.061619 LBFGS: function start/end, n_calls: 41.773074 41.610785 52
cycle:  12 max_shift: 0.009230 LBFGS: function start/end, n_calls: 41.610785 41.495457 52
cycle:  13 max_shift: 0.149323 LBFGS: function start/end, n_calls: 41.495457 41.168104 52
cycle:  14 max_shift: 0.010861 LBFGS: function start/end, n_calls: 41.168104 40.995337 52
cycle:  15 max_shift: 0.145756 LBFGS: function start/end, n_calls: 40.995337 40.773327 52
cycle:  16 max_shift: 0.013762 LBFGS: function start/end, n_calls: 40.773327 40.650126 52
cycle:  17 max_shift: 0.031345 LBFGS: function start/end, n_calls: 40.650126 40.611657 52
cycle:  18 max_shift: 0.019892 LBFGS: function start/end, n_calls: 40.611657 40.581436 52
cycle:  19 max_shift: 0.019878 LBFGS: function start/end, n_calls: 40.581436 40.555765 52
cycle:  20 max_shift: 0.014390 LBFGS: function start/end, n_calls: 40.555765 40.532834 52
cycle:  21 max_shift: 0.018677 LBFGS: function start/end, n_calls: 40.532834 40.513748 53
cycle:  22 max_shift: 0.016371 LBFGS: function start/end, n_calls: 40.513748 40.489347 52
cycle:  23 max_shift: 0.023283 LBFGS: function start/end, n_calls: 40.489347 40.464121 52
cycle:  24 max_shift: 0.013945 LBFGS: function start/end, n_calls: 40.464121 40.438095 52
cycle:  25 max_shift: 0.027174 LBFGS: function start/end, n_calls: 40.438095 40.409551 52
cycle:  26 max_shift: 0.015307 LBFGS: function start/end, n_calls: 40.409551 40.382586 52
cycle:  27 max_shift: 0.023383 LBFGS: function start/end, n_calls: 40.382586 40.357108 52
cycle:  28 max_shift: 0.015104 LBFGS: function start/end, n_calls: 40.357108 40.334619 52
cycle:  29 max_shift: 0.018114 LBFGS: function start/end, n_calls: 40.334619 40.317756 52
cycle:  30 max_shift: 0.016188 LBFGS: function start/end, n_calls: 40.317756 40.297104 52
cycle:  31 max_shift: 0.042989 LBFGS: function start/end, n_calls: 40.297104 40.264983 52
cycle:  32 max_shift: 0.013395 LBFGS: function start/end, n_calls: 40.264983 40.235034 52
cycle:  33 max_shift: 0.050204 LBFGS: function start/end, n_calls: 40.235034 40.202307 52
cycle:  34 max_shift: 0.015047 LBFGS: function start/end, n_calls: 40.202307 40.168470 52
cycle:  35 max_shift: 0.035713 LBFGS: function start/end, n_calls: 40.168470 40.142881 52
cycle:  36 max_shift: 0.017696 LBFGS: function start/end, n_calls: 40.142881 40.119787 52
cycle:  37 max_shift: 0.029052 LBFGS: function start/end, n_calls: 40.119787 40.099448 52
cycle:  38 max_shift: 0.017670 LBFGS: function start/end, n_calls: 40.099448 40.080406 53
cycle:  39 max_shift: 0.030319 LBFGS: function start/end, n_calls: 40.080406 40.060343 52
cycle:  40 max_shift: 0.019375 LBFGS: function start/end, n_calls: 40.060343 40.038667 52
cycle:  41 max_shift: 0.021237 LBFGS: function start/end, n_calls: 40.038667 40.021067 52
cycle:  42 max_shift: 0.022726 LBFGS: function start/end, n_calls: 40.021067 40.003635 52
cycle:  43 max_shift: 0.013563 LBFGS: function start/end, n_calls: 40.003635 39.989579 54
cycle:  44 max_shift: 0.032547 LBFGS: function start/end, n_calls: 39.989579 39.967611 52
cycle:  45 max_shift: 0.013383 LBFGS: function start/end, n_calls: 39.967611 39.948795 53
cycle:  46 max_shift: 0.036673 LBFGS: function start/end, n_calls: 39.948795 39.928301 52
cycle:  47 max_shift: 0.010464 LBFGS: function start/end, n_calls: 39.928301 39.908972 52
cycle:  48 max_shift: 0.025727 LBFGS: function start/end, n_calls: 39.908972 39.893287 53
cycle:  49 max_shift: 0.013042 LBFGS: function start/end, n_calls: 39.893287 39.880504 52
cycle:  50 max_shift: 0.021451 LBFGS: function start/end, n_calls: 39.880504 39.868188 52
cycle:  51 max_shift: 0.011470 LBFGS: function start/end, n_calls: 39.868188 39.857548 52
cycle:  52 max_shift: 0.023324 LBFGS: function start/end, n_calls: 39.857548 39.846734 53
cycle:  53 max_shift: 0.012575 LBFGS: function start/end, n_calls: 39.846734 39.834091 52
cycle:  54 max_shift: 0.050426 LBFGS: function start/end, n_calls: 39.834091 39.814050 52
cycle:  55 max_shift: 0.011776 LBFGS: function start/end, n_calls: 39.814050 39.792932 52
cycle:  56 max_shift: 0.021275 LBFGS: function start/end, n_calls: 39.792932 39.784776 52
cycle:  57 max_shift: 0.008653 LBFGS: function start/end, n_calls: 39.784776 39.776091 52
cycle:  58 max_shift: 0.012302 LBFGS: function start/end, n_calls: 39.776091 39.771258 52
cycle:  59 max_shift: 0.009533 LBFGS: function start/end, n_calls: 39.771258 39.765431 53
cycle:  60 max_shift: 0.011415 LBFGS: function start/end, n_calls: 39.765431 39.759658 52
cycle:  61 max_shift: 0.008482 LBFGS: function start/end, n_calls: 39.759658 39.754852 52
cycle:  62 max_shift: 0.008909 LBFGS: function start/end, n_calls: 39.754852 39.750782 52
cycle:  63 max_shift: 0.007317 LBFGS: function start/end, n_calls: 39.750782 39.746966 53
cycle:  64 max_shift: 0.008335 LBFGS: function start/end, n_calls: 39.746966 39.743278 52
cycle:  65 max_shift: 0.006461 LBFGS: function start/end, n_calls: 39.743278 39.740265 53
cycle:  66 max_shift: 0.009027 LBFGS: function start/end, n_calls: 39.740265 39.736200 52
cycle:  67 max_shift: 0.009001 LBFGS: function start/end, n_calls: 39.736200 39.731889 52
cycle:  68 max_shift: 0.006094 LBFGS: function start/end, n_calls: 39.731889 39.728848 53
cycle:  69 max_shift: 0.007276 LBFGS: function start/end, n_calls: 39.728848 39.725959 52
cycle:  70 max_shift: 0.006297 LBFGS: function start/end, n_calls: 39.725959 39.722981 52
cycle:  71 max_shift: 0.006640 LBFGS: function start/end, n_calls: 39.722981 39.720065 52
cycle:  72 max_shift: 0.005853 LBFGS: function start/end, n_calls: 39.720065 39.717499 52
cycle:  73 max_shift: 0.004327 LBFGS: function start/end, n_calls: 39.717499 39.715476 53
cycle:  74 max_shift: 0.007167 LBFGS: function start/end, n_calls: 39.715476 39.712920 52
cycle:  75 max_shift: 0.004221 LBFGS: function start/end, n_calls: 39.712920 39.710309 52
cycle:  76 max_shift: 0.007446 LBFGS: function start/end, n_calls: 39.710309 39.707873 52
cycle:  77 max_shift: 0.003973 LBFGS: function start/end, n_calls: 39.707873 39.705293 52
cycle:  78 max_shift: 0.007423 LBFGS: function start/end, n_calls: 39.705293 39.702599 52
cycle:  79 max_shift: 0.004245 LBFGS: function start/end, n_calls: 39.702599 39.699529 52
cycle:  80 max_shift: 0.028327 LBFGS: function start/end, n_calls: 39.699529 39.689959 52
cycle:  81 max_shift: 0.005231 LBFGS: function start/end, n_calls: 39.689959 39.681767 52
cycle:  82 max_shift: 0.008067 LBFGS: function start/end, n_calls: 39.681767 39.678961 52
cycle:  83 max_shift: 0.002975 LBFGS: function start/end, n_calls: 39.678961 39.676295 52
cycle:  84 max_shift: 0.016607 LBFGS: function start/end, n_calls: 39.676295 39.671686 52
cycle:  85 max_shift: 0.004120 LBFGS: function start/end, n_calls: 39.671686 39.666515 52
cycle:  86 max_shift: 0.009659 LBFGS: function start/end, n_calls: 39.666515 39.663805 52
cycle:  87 max_shift: 0.002783 LBFGS: function start/end, n_calls: 39.663805 39.661095 52
cycle:  88 max_shift: 0.005297 LBFGS: function start/end, n_calls: 39.661095 39.659556 52
cycle:  89 max_shift: 0.002292 LBFGS: function start/end, n_calls: 39.659556 39.657859 52
cycle:  90 max_shift: 0.009763 LBFGS: function start/end, n_calls: 39.657859 39.655334 52
cycle:  91 max_shift: 0.002287 LBFGS: function start/end, n_calls: 39.655334 39.652674 52
cycle:  92 max_shift: 0.021788 LBFGS: function start/end, n_calls: 39.652674 39.647726 52
cycle:  93 max_shift: 0.004025 LBFGS: function start/end, n_calls: 39.647726 39.642916 52
cycle:  94 max_shift: 0.002881 LBFGS: function start/end, n_calls: 39.642916 39.641726 52
cycle:  95 max_shift: 0.001653 LBFGS: function start/end, n_calls: 39.641726 39.640897 52
cycle:  96 max_shift: 0.001899 LBFGS: function start/end, n_calls: 39.640897 39.640234 52
cycle:  97 max_shift: 0.001443 LBFGS: function start/end, n_calls: 39.640234 39.639617 52
cycle:  98 max_shift: 0.002169 LBFGS: function start/end, n_calls: 39.639617 39.638823 52
cycle:  99 max_shift: 0.002130 LBFGS: function start/end, n_calls: 39.638823 39.638014 52
final: bond:  0.000 angle:   0.25 clash:   0.0 rota:  0.00 rama: f:  81.82 o:   0.00 Z:  -4.10 cb:   0.00
See 5_refined.pdb in pdb folder.
Time: 4.9599
