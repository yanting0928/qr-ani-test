Starting Q|R
version:   v1.0-208-g2886d5-dirty  
Running refinement
   input {
     xray_data {
       file_name = None
       labels = None
       high_resolution = None
       low_resolution = None
       outliers_rejection = True
       french_wilson_scale = True
       french_wilson {
         max_bins = 60
         min_bin_size = 40
       }
       sigma_fobs_rejection_criterion = None
       sigma_iobs_rejection_criterion = None
       ignore_all_zeros = True
       force_anomalous_flag_to_be_equal_to = None
       convert_to_non_anomalous_if_ratio_pairs_lone_less_than_threshold = 0.5
       r_free_flags {
         file_name = None
         label = None
         test_flag_value = None
         ignore_r_free_flags = False
         disable_suitability_test = False
         ignore_pdb_hexdigest = False
         generate = False
         fraction = 0.1
         max_free = 2000
         lattice_symmetry_max_delta = 5
         use_lattice_symmetry = True
         use_dataman_shells = False
         n_shells = 20
       }
     }
     pdb {
       file_name = None
     }
     monomers {
       file_name = None
     }
     maps {
       map_file_name = None
       d_min = None
       map_coefficients_file_name = None
       map_coefficients_label = None
     }
     sequence = None
     scattering_table = wk1995 it1992 *n_gaussian neutron electron
     wavelength = None
     energy = None
     twin_law = Auto
   }
   max_atoms = 15000
   debug = False
   cluster {
     fast_interaction = True
     charge_cutoff = 8.0
     clustering = false
     charge_embedding = False
     two_buffers = False
     maxnum_residues_in_cluster = 15
     select_within_radius = 10
     clustering_method = gnc *bcc
     altloc_method = average *subtract
     g_scan = 10 15 20
     g_mode = None
     save_clusters = True
     bond_with_altloc = True
     re_calculate_rmsd_tolerance = 0.5
   }
   restraints = *cctbx qm
   expansion = False
   quantum {
     engine_name = *mopac ani torchani terachem turbomole pyscf orca gaussian \
                   xtb
     basis = Auto
     charge = None
     method = Auto
     memory = None
     nproc = None
     qm_addon = gcp dftd3 gcp-d3
     qm_addon_method = None
   }
   refine {
     dry_run = False
     sf_algorithm = *direct fft
     refinement_target_name = *ml ls_wunit_k1
     mode = *opt refine gtest
     number_of_macro_cycles = 1
     number_of_weight_search_cycles = 50
     number_of_refine_cycles = 5
     number_of_micro_cycles = 100
     data_weight = None
     choose_best_use_r_work = False
     skip_weight_search = False
     adjust_restraints_weight_scale_value = 2
     max_iterations_weight = 50
     max_iterations_refine = 50
     use_ase_lbfgs = False
     line_search = True
     stpmax = 0.2
     gradient_only = False
     update_all_scales = True
     refine_sites = True
     refine_adp = False
     restraints_weight_scale = 1.0
     shake_sites = False
     use_convergence_test = True
     max_bond_rmsd = 0.03
     max_r_work_r_free_gap = 5.0
     r_tolerance = 0.001
     rmsd_tolerance = 0.01
     opt_log = False
     pre_opt = False
     pre_opt_stpmax = 0.1
     pre_opt_iter = 10
     pre_opt_switch = 2
     pre_opt_gconv = 3000
     minimizer = lbfgs *lbfgsb
   }
   parallel {
     method = *multiprocessing slurm pbs sge lsf threading
     nproc = None
     qsub_command = None
   }
   output_file_name_prefix = None
   output_folder_name = "pdb"
   rst_file = None
   dump_gradients = None

Setting QM defaults
  Setting QM method to PM7


***********************************************************
restart info will be stored in /home/yanting/work/aniserver_1_qr/ani_qr_test/cctbx_lbfgs/qr-ani-test/qr-cctbx/lbfgs_b/0.6/pdb/9.rst.pickle
***********************************************************

start: bond:  0.013 angle:   1.79 clash:  22.0 rota:  0.00 rama: f:  90.91 o:   0.00 Z:  -5.70 cb:   0.00
cycle:   0 max_shift: 0.178046 LBFGS-B: function start/end, n_calls: 287.539624438 52.5686102854 52
cycle:   1 max_shift: 0.202730 LBFGS-B: function start/end, n_calls: 52.5686102854 45.7788729819 52
cycle:   2 max_shift: 0.163303 LBFGS-B: function start/end, n_calls: 45.7788729819 43.448723313 52
cycle:   3 max_shift: 0.038336 LBFGS-B: function start/end, n_calls: 43.448723313 42.5095439502 51
cycle:   4 max_shift: 0.108482 LBFGS-B: function start/end, n_calls: 42.5095439502 41.573875062 52
cycle:   5 max_shift: 0.025613 LBFGS-B: function start/end, n_calls: 41.573875062 41.0938306499 52
cycle:   6 max_shift: 0.046858 LBFGS-B: function start/end, n_calls: 41.0938306499 40.8360461374 52
cycle:   7 max_shift: 0.015481 LBFGS-B: function start/end, n_calls: 40.8360461374 40.6436397173 52
cycle:   8 max_shift: 0.059295 LBFGS-B: function start/end, n_calls: 40.6436397173 40.4332256742 52
cycle:   9 max_shift: 0.013371 LBFGS-B: function start/end, n_calls: 40.4332256742 40.2871454668 51
cycle:  10 max_shift: 0.026317 LBFGS-B: function start/end, n_calls: 40.2871454668 40.207759107 52
cycle:  11 max_shift: 0.012558 LBFGS-B: function start/end, n_calls: 40.207759107 40.1378890692 52
cycle:  12 max_shift: 0.019955 LBFGS-B: function start/end, n_calls: 40.1378890692 40.0876817099 52
cycle:  13 max_shift: 0.010853 LBFGS-B: function start/end, n_calls: 40.0876817099 40.0377113374 51
cycle:  14 max_shift: 0.027248 LBFGS-B: function start/end, n_calls: 40.0377113374 39.9816666694 52
cycle:  15 max_shift: 0.008164 LBFGS-B: function start/end, n_calls: 39.9816666694 39.9285412471 51
cycle:  16 max_shift: 0.032972 LBFGS-B: function start/end, n_calls: 39.9285412471 39.8718366204 51
cycle:  17 max_shift: 0.008651 LBFGS-B: function start/end, n_calls: 39.8718366204 39.831068123 51
cycle:  18 max_shift: 0.015428 LBFGS-B: function start/end, n_calls: 39.831068123 39.8026507445 51
cycle:  19 max_shift: 0.005179 LBFGS-B: function start/end, n_calls: 39.8026507445 39.7820757203 52
cycle:  20 max_shift: 0.018086 LBFGS-B: function start/end, n_calls: 39.7820757203 39.7564453523 51
cycle:  21 max_shift: 0.005817 LBFGS-B: function start/end, n_calls: 39.7564453523 39.7381144089 52
cycle:  22 max_shift: 0.009112 LBFGS-B: function start/end, n_calls: 39.7381144089 39.7260092085 52
cycle:  23 max_shift: 0.005119 LBFGS-B: function start/end, n_calls: 39.7260092085 39.7159309095 51
cycle:  24 max_shift: 0.005386 LBFGS-B: function start/end, n_calls: 39.7159309095 39.7086777035 51
cycle:  25 max_shift: 0.010482 LBFGS-B: function start/end, n_calls: 39.7086777035 39.6966547739 52
cycle:  26 max_shift: 0.003679 LBFGS-B: function start/end, n_calls: 39.6966547739 39.6858595059 51
cycle:  27 max_shift: 0.007661 LBFGS-B: function start/end, n_calls: 39.6858595059 39.6781279429 51
cycle:  28 max_shift: 0.003961 LBFGS-B: function start/end, n_calls: 39.6781279429 39.6716478879 52
cycle:  29 max_shift: 0.008575 LBFGS-B: function start/end, n_calls: 39.6716478879 39.6652119787 52
cycle:  30 max_shift: 0.003847 LBFGS-B: function start/end, n_calls: 39.6652119787 39.6580996271 52
cycle:  31 max_shift: 0.006371 LBFGS-B: function start/end, n_calls: 39.6580996271 39.6533929362 51
cycle:  32 max_shift: 0.003069 LBFGS-B: function start/end, n_calls: 39.6533929362 39.6484072195 51
cycle:  33 max_shift: 0.008260 LBFGS-B: function start/end, n_calls: 39.6484072195 39.6425230325 52
cycle:  34 max_shift: 0.003139 LBFGS-B: function start/end, n_calls: 39.6425230325 39.6369506741 52
cycle:  35 max_shift: 0.007607 LBFGS-B: function start/end, n_calls: 39.6369506741 39.6319509895 52
cycle:  36 max_shift: 0.002651 LBFGS-B: function start/end, n_calls: 39.6319509895 39.6270221378 51
cycle:  37 max_shift: 0.009267 LBFGS-B: function start/end, n_calls: 39.6270221378 39.6226252687 51
cycle:  38 max_shift: 0.003013 LBFGS-B: function start/end, n_calls: 39.6226252687 39.6164489195 52
cycle:  39 max_shift: 0.007843 LBFGS-B: function start/end, n_calls: 39.6164489195 39.6123239061 51
cycle:  40 max_shift: 0.002618 LBFGS-B: function start/end, n_calls: 39.6123239061 39.6077617001 52
cycle:  41 max_shift: 0.011739 LBFGS-B: function start/end, n_calls: 39.6077617001 39.6014672489 52
cycle:  42 max_shift: 0.002951 LBFGS-B: function start/end, n_calls: 39.6014672489 39.5960591818 52
cycle:  43 max_shift: 0.006850 LBFGS-B: function start/end, n_calls: 39.5960591818 39.5931398045 52
cycle:  44 max_shift: 0.002051 LBFGS-B: function start/end, n_calls: 39.5931398045 39.5898689037 52
cycle:  45 max_shift: 0.012057 LBFGS-B: function start/end, n_calls: 39.5898689037 39.5845082584 52
cycle:  46 max_shift: 0.002209 LBFGS-B: function start/end, n_calls: 39.5845082584 39.5805921256 51
cycle:  47 max_shift: 0.010504 LBFGS-B: function start/end, n_calls: 39.5805921256 39.5769411177 51
cycle:  48 max_shift: 0.002095 LBFGS-B: function start/end, n_calls: 39.5769411177 39.5736407452 51
cycle:  49 max_shift: 0.004619 LBFGS-B: function start/end, n_calls: 39.5736407452 39.5722802073 52
cycle:  50 max_shift: 0.001702 LBFGS-B: function start/end, n_calls: 39.5722802073 39.5709498944 52
cycle:  51 max_shift: 0.004553 LBFGS-B: function start/end, n_calls: 39.5709498944 39.5695738275 52
cycle:  52 max_shift: 0.001458 LBFGS-B: function start/end, n_calls: 39.5695738275 39.5681414171 52
cycle:  53 max_shift: 0.003028 LBFGS-B: function start/end, n_calls: 39.5681414171 39.5672870139 52
cycle:  54 max_shift: 0.001620 LBFGS-B: function start/end, n_calls: 39.5672870139 39.5663588755 52
cycle:  55 max_shift: 0.002496 LBFGS-B: function start/end, n_calls: 39.5663588755 39.5655397763 52
cycle:  56 max_shift: 0.001071 LBFGS-B: function start/end, n_calls: 39.5655397763 39.5647308345 51
cycle:  57 max_shift: 0.002335 LBFGS-B: function start/end, n_calls: 39.5647308345 39.5639956838 52
cycle:  58 max_shift: 0.001221 LBFGS-B: function start/end, n_calls: 39.5639956838 39.5633428624 52
cycle:  59 max_shift: 0.001620 LBFGS-B: function start/end, n_calls: 39.5633428624 39.5628394019 51
cycle:  60 max_shift: 0.001028 LBFGS-B: function start/end, n_calls: 39.5628394019 39.5623262636 51
cycle:  61 max_shift: 0.002028 LBFGS-B: function start/end, n_calls: 39.5623262636 39.5617963015 52
cycle:  62 max_shift: 0.001048 LBFGS-B: function start/end, n_calls: 39.5617963015 39.5612183121 52
cycle:  63 max_shift: 0.001622 LBFGS-B: function start/end, n_calls: 39.5612183121 39.560713626 51
cycle:  64 max_shift: 0.001091 LBFGS-B: function start/end, n_calls: 39.560713626 39.5602241901 51
cycle:  65 max_shift: 0.001394 LBFGS-B: function start/end, n_calls: 39.5602241901 39.5597825241 51
cycle:  66 max_shift: 0.002845 LBFGS-B: function start/end, n_calls: 39.5597825241 39.5589745905 52
cycle:  67 max_shift: 0.001020 LBFGS-B: function start/end, n_calls: 39.5589745905 39.5583059899 51
cycle:  68 max_shift: 0.004179 LBFGS-B: function start/end, n_calls: 39.5583059899 39.5575266213 51
cycle:  69 max_shift: 0.001238 LBFGS-B: function start/end, n_calls: 39.5575266213 39.5565571192 51
cycle:  70 max_shift: 0.003335 LBFGS-B: function start/end, n_calls: 39.5565571192 39.5558166344 51
cycle:  71 max_shift: 0.000962 LBFGS-B: function start/end, n_calls: 39.5558166344 39.5551847141 51
cycle:  72 max_shift: 0.011639 LBFGS-B: function start/end, n_calls: 39.5551847141 39.5528958152 51
cycle:  73 max_shift: 0.001421 LBFGS-B: function start/end, n_calls: 39.5528958152 39.5511877632 51
cycle:  74 max_shift: 0.003614 LBFGS-B: function start/end, n_calls: 39.5511877632 39.5505632579 51
cycle:  75 max_shift: 0.000846 LBFGS-B: function start/end, n_calls: 39.5505632579 39.5500007535 51
cycle:  76 max_shift: 0.002439 LBFGS-B: function start/end, n_calls: 39.5500007535 39.5495516122 52
cycle:  77 max_shift: 0.000830 LBFGS-B: function start/end, n_calls: 39.5495516122 39.5491667768 52
Convergence reached. Stopping now.
final: bond:  0.000 angle:   0.26 clash:   0.0 rota:  0.00 rama: f: 100.00 o:   0.00 Z:  -1.62 cb:   0.00
See 9_refined.pdb in pdb folder.
Time: 4.8336
